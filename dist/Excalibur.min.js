/*! excalibur - v0.2.2 - 2014-04-15
* https://github.com/excaliburjs/Excalibur
* Copyright (c) 2014 ; Licensed BSD*/
"undefined"==typeof window&&(window={audioContext:function(){}}),"undefined"==typeof window||window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setInterval(t,1e3/60)}),"undefined"==typeof window||window.AudioContext||(window.AudioContext=window.webkitAudioContext||window.mozAudioContext),Array.prototype.some||(Array.prototype.some=function(t){"use strict";if(void 0===this||null===this)throw new TypeError;var e=Object(this),i=e.length>>>0;if("function"!=typeof t)throw new TypeError;for(var s=arguments.length>=2?arguments[1]:void 0,n=0;i>n;n++)if(n in e&&t.call(s,e[n],n,e))return!0;return!1});var __extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);i.prototype=e.prototype,t.prototype=new i},ex;(function(t){var e=function(){function t(t,e){this.x=t,this.y=e}return t}();t.Point=e;var i=function(t){function e(e,i){t.call(this,e,i),this.x=e,this.y=i}return __extends(e,t),e.prototype.distance=function(t){return t||(t=new e(0,0)),Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))},e.prototype.normalize=function(){var t=this.distance();return t>0?new e(this.x/t,this.y/t):new e(0,1)},e.prototype.scale=function(t){return new e(this.x*t,this.y*t)},e.prototype.add=function(t){return new e(this.x+t.x,this.y+t.y)},e.prototype.minus=function(t){return new e(this.x-t.x,this.y-t.y)},e.prototype.dot=function(t){return this.x*t.x+this.y*t.y},e.prototype.cross=function(t){return this.x*t.y-this.y*t.x},e}(e);t.Vector=i})(ex||(ex={}));var ex;(function(t){(function(t){t[t.Debug=0]="Debug",t[t.Info=1]="Info",t[t.Warn=2]="Warn",t[t.Error=3]="Error",t[t.Fatal=4]="Fatal"})(t.LogLevel||(t.LogLevel={}));var e=t.LogLevel,i=function(){function t(){if(this.appenders=[],this.defaultLevel=1,t._instance)throw Error("Logger is a singleton");return t._instance=this,t._instance.addAppender(new s),t._instance}return t.getInstance=function(){return null==t._instance&&(t._instance=new t),t._instance},t.prototype.addAppender=function(t){this.appenders.push(t)},t.prototype.clearAppenders=function(){this.appenders.length=0},t.prototype._log=function(t,e){var i=this;null==t&&(t=this.defaultLevel),this.appenders.forEach(function(s){t>=i.defaultLevel&&s.log(t,e)})},t.prototype.debug=function(){for(var t=[],e=0;arguments.length-0>e;e++)t[e]=arguments[e+0];this._log(0,t)},t.prototype.info=function(){for(var t=[],e=0;arguments.length-0>e;e++)t[e]=arguments[e+0];this._log(1,t)},t.prototype.warn=function(){for(var t=[],e=0;arguments.length-0>e;e++)t[e]=arguments[e+0];this._log(2,t)},t.prototype.error=function(){for(var t=[],e=0;arguments.length-0>e;e++)t[e]=arguments[e+0];this._log(3,t)},t.prototype.fatal=function(){for(var t=[],e=0;arguments.length-0>e;e++)t[e]=arguments[e+0];this._log(4,t)},t._instance=null,t}();t.Logger=i;var s=function(){function t(){}return t.prototype.log=function(t,i){var s=[];s.unshift.apply(s,i),s.unshift("["+e[t]+"] : "),2>t?console.log.apply(console,s):3>t?console.warn.apply(console,s):console.error.apply(console,s)},t}();t.ConsoleAppender=s;var n=function(){function t(t,e){this._messages=[],this.canvas=document.createElement("canvas"),this.canvas.width=t||window.innerWidth,this.canvas.height=e||window.innerHeight,this.canvas.style.position="absolute",this.ctx=this.canvas.getContext("2d"),document.body.appendChild(this.canvas)}return t.prototype.log=function(t,i){var s=i.join(",");this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this._messages.unshift("["+e[t]+"] : "+s);for(var n=10,o=1,r=0;this._messages.length>r;r++)this.ctx.fillStyle="rgba(255,255,255,"+o.toFixed(2)+")",this.ctx.fillText(this._messages[r],200,n),n+=10,o=o>0?o-.05:0},t}();t.ScreenAppender=n})(ex||(ex={}));var ex;(function(t){(function(t){t[t.KeyDown=0]="KeyDown",t[t.KeyUp=1]="KeyUp",t[t.KeyPress=2]="KeyPress",t[t.MouseDown=3]="MouseDown",t[t.MouseMove=4]="MouseMove",t[t.MouseUp=5]="MouseUp",t[t.TouchStart=6]="TouchStart",t[t.TouchMove=7]="TouchMove",t[t.TouchEnd=8]="TouchEnd",t[t.TouchCancel=9]="TouchCancel",t[t.Click=10]="Click",t[t.Collision=11]="Collision",t[t.EnterViewPort=12]="EnterViewPort",t[t.ExitViewPort=13]="ExitViewPort",t[t.Blur=14]="Blur",t[t.Focus=15]="Focus",t[t.Update=16]="Update",t[t.Activate=17]="Activate",t[t.Deactivate=18]="Deactivate",t[t.Initialize=19]="Initialize"})(t.EventType||(t.EventType={})),t.EventType;var e=function(){function t(){}return t}();t.GameEvent=e;var i=function(t){function e(){t.call(this)}return __extends(e,t),e}(e);t.FocusEvent=i;var s=function(t){function e(){t.call(this)}return __extends(e,t),e}(e);t.BlurEvent=s;var n=function(t){function e(e,i,s,n){t.call(this),this.actor=e,this.other=i,this.side=s,this.intersection=n}return __extends(e,t),e}(e);t.CollisionEvent=n;var o=function(t){function e(e){t.call(this),this.delta=e}return __extends(e,t),e}(e);t.UpdateEvent=o;var r=function(t){function e(e){t.call(this),this.engine=e}return __extends(e,t),e}(e);t.InitializeEvent=r;var h=function(t){function e(e){t.call(this),this.oldScene=e}return __extends(e,t),e}(e);t.ActivateEvent=h;var a=function(t){function e(e){t.call(this),this.newScene=e}return __extends(e,t),e}(e);t.DeactivateEvent=a;var c=function(t){function e(){t.call(this)}return __extends(e,t),e}(e);t.ExitViewPortEvent=c;var l=function(t){function e(){t.call(this)}return __extends(e,t),e}(e);t.EnterViewPortEvent=l;var u=function(t){function e(e){t.call(this),this.key=e}return __extends(e,t),e}(e);t.KeyEvent=u;var p=function(t){function e(e){t.call(this),this.key=e}return __extends(e,t),e}(e);t.KeyDown=p;var d=function(t){function e(e){t.call(this),this.key=e}return __extends(e,t),e}(e);t.KeyUp=d;var f=function(t){function e(e){t.call(this),this.key=e}return __extends(e,t),e}(e);t.KeyPress=f,function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right"}(t.MouseButton||(t.MouseButton={})),t.MouseButton;var A=function(t){function e(e,i,s){t.call(this),this.x=e,this.y=i,this.mouseEvent=s}return __extends(e,t),e}(e);t.MouseDown=A;var g=function(t){function e(e,i,s){t.call(this),this.x=e,this.y=i,this.mouseEvent=s}return __extends(e,t),e}(e);t.MouseMove=g;var y=function(t){function e(e,i,s){t.call(this),this.x=e,this.y=i,this.mouseEvent=s}return __extends(e,t),e}(e);t.MouseUp=y;var v=function(t){function e(e,i){t.call(this),this.x=e,this.y=i}return __extends(e,t),e}(e);t.TouchStart=v;var m=function(t){function e(e,i){t.call(this),this.x=e,this.y=i}return __extends(e,t),e}(e);t.TouchMove=m;var x=function(t){function e(e,i){t.call(this),this.x=e,this.y=i}return __extends(e,t),e}(e);t.TouchEnd=x;var w=function(t){function e(e,i){t.call(this),this.x=e,this.y=i}return __extends(e,t),e}(e);t.TouchCancel=w;var C=function(t){function e(e,i,s){t.call(this),this.x=e,this.y=i,this.mouseEvent=s}return __extends(e,t),e}(e);t.Click=C;var E=function(){function i(e){this._handlers={},this.queue=[],this.log=t.Logger.getInstance(),this.target=e}return i.prototype.publish=function(t,i){if(t){t=t.toLowerCase();var s=this.queue,n=this.target;i||(i=new e),i.target=n,this._handlers[t]&&this._handlers[t].forEach(function(t){s.push(function(){t.call(n,i)})})}},i.prototype.subscribe=function(t,e){t=t.toLowerCase(),this._handlers[t]||(this._handlers[t]=[]),this._handlers[t].push(e)},i.prototype.unsubscribe=function(t,e){t=t.toLowerCase();var i=this._handlers[t];if(i)if(e){var s=i.indexOf(e);this._handlers[t].splice(s,1)}else this._handlers[t].length=0},i.prototype.update=function(){for(var t;t=this.queue.shift();)t()},i}();t.EventDispatcher=E})(ex||(ex={}));var ex;(function(t){(function(e){function i(t){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i="",s=0;t.length>s;){var n,o,r=255&t.charCodeAt(s++),h=255&t.charCodeAt(s++),a=255&t.charCodeAt(s++),c=r>>2,l=(3&r)<<4|h>>4;isNaN(h)?n=o=64:(n=(15&h)<<2|a>>6,o=isNaN(a)?64:63&a),i+=e.charAt(c)+e.charAt(l)+e.charAt(n)+e.charAt(o)}return i}function s(t,e,i){return e>=t?e:t>=i?i:t}function n(t,e,i,s,n,o){t.beginPath(),t.strokeStyle=e,t.moveTo(i,s),t.lineTo(n,o),t.closePath(),t.stroke()}function o(t,e){return t+Math.random()*(e-t)}function r(e){var i=0,s=0,n=function(t){i+=t.offsetLeft,t.offsetParent&&n(t.offsetParent)},o=function(t){s+=t.offsetTop,t.offsetParent&&o(t.offsetParent)};return n(e),o(e),new t.Point(i,s)}var h=function(){function e(){this.eventDispatcher=new t.EventDispatcher(this)}return e.prototype.addEventListener=function(t,e){this.eventDispatcher.subscribe(t,e)},e.prototype.removeEventListener=function(t,e){this.eventDispatcher.unsubscribe(t,e)},e.prototype.on=function(t,e){this.eventDispatcher.subscribe(t,e)},e.prototype.off=function(t,e){this.eventDispatcher.unsubscribe(t,e)},e.extend=function(t){var i,s=this;i=t&&t.hasOwnProperty("constructor")?t.constructor:function(){return s.apply(this,arguments)};var n=function(){this.constructor=i};if(n.prototype=s.prototype,i.prototype=new n,t)for(var o in t)t.hasOwnProperty(o)&&(i.prototype[o]=t[o]);return i.extend=e.extend,i},e}();e.Class=h,e.base64Encode=i,e.clamp=s,e.drawLine=n,e.randomInRange=o,e.getPosition=r;var a=function(){function t(e){this.internalArray=null,this.endPointer=0;var i=e||t.DefaultSize;this.internalArray=Array(i)}return t.prototype.resize=function(){for(var t=2*this.internalArray.length,e=Array(t),i=this.count(),s=0;i>s;s++)e[s]=this.internalArray[s];delete this.internalArray,this.internalArray=e},t.prototype.push=function(t){return this.endPointer===this.internalArray.length&&this.resize(),this.internalArray[this.endPointer++]=t},t.prototype.pop=function(){return this.endPointer=0>this.endPointer-1?0:this.endPointer-1,this.internalArray[this.endPointer]},t.prototype.count=function(){return this.endPointer},t.prototype.clear=function(){this.endPointer=0},t.prototype.internalSize=function(){return this.internalArray.length},t.prototype.elementAt=function(t){return t>=this.count()?void 0:this.internalArray[t]},t.prototype.insert=function(t,e){return t>=this.count()&&this.resize(),this.internalArray[t]=e},t.prototype.remove=function(t){var e=this.count();if(0!==e){for(var i=this.internalArray[t],s=t;e>s;s++)this.internalArray[s]=this.internalArray[s+1];return this.endPointer--,i}},t.prototype.removeElement=function(t){var e=this.internalArray.indexOf(t);this.remove(e)},t.prototype.toArray=function(){return this.internalArray.slice(0,this.endPointer)},t.prototype.forEach=function(t){for(var e=this.count(),i=0;e>i;i++)t.call(this,this.internalArray[i],i)},t.prototype.map=function(t){for(var e=this.count(),i=0;e>i;i++)this.internalArray[i]=t.call(this,this.internalArray[i],i)},t.DefaultSize=200,t}();e.Collection=a})(t.Util||(t.Util={})),t.Util})(ex||(ex={}));var ex;(function(t){var e=function(){function e(e,i,s,n,o,r,h){r===void 0&&(r=!1),h===void 0&&(h=-1),this.x=e,this.y=i,this.width=s,this.height=n,this.index=o,this.solid=r,this.spriteId=h,this._bounds=new t.BoundingBox(this.x,this.y,this.x+this.width,this.y+this.height)}return e.prototype.getBounds=function(){return this._bounds},e}();t.Cell=e;var i=function(){function i(t,i,s,n,o,r,h){var a=this;this.x=t,this.y=i,this.cellWidth=s,this.cellHeight=n,this.rows=o,this.cols=r,this.spriteSheet=h,this._collidingX=-1,this._collidingY=-1,this._onScreenXStart=0,this._onScreenXEnd=9999,this._onScreenYStart=0,this._onScreenYEnd=9999,this.data=[],this.data=Array(o*r);for(var c=0;r>c;c++)for(var l=0;o>l;l++)(function(){var o=new e(c*s+t,l*n+i,s,n,c+l*r);a.data[c+l*r]=o})()}return i.prototype.collides=function(e){for(var i=e.x+e.getWidth(),s=e.y+e.getHeight(),n=e.getBounds(),o=[],r=e.x;i>=r;r+=Math.min(e.getWidth()/2,this.cellWidth/2))for(var h=e.y;s>=h;h+=Math.min(e.getHeight()/2,this.cellHeight/2)){var a=this.getCellByPoint(r,h);if(a&&a.solid){var c=n.collides(a.getBounds());c&&o.push(c)}}if(0===o.length)return null;var l=o.reduce(function(e,i){var s=e.x,n=e.y;return Math.abs(e.x)<Math.abs(i.x)&&(s=i.x),Math.abs(e.y)<Math.abs(i.y)&&(n=i.y),new t.Vector(s,n)});return l},i.prototype.getCellByIndex=function(t){return this.data[t]},i.prototype.getCell=function(t,e){return 0>t||0>e||t>=this.cols||e>=this.rows?null:this.data[t+e*this.cols]},i.prototype.getCellByPoint=function(t,e){var t=Math.floor((t-this.x)/this.cellWidth),e=Math.floor((e-this.y)/this.cellHeight),i=this.getCell(t,e);return t>=0&&e>=0&&this.cols>t&&this.rows>e&&i?i:null},i.prototype.update=function(e){var i=e.screenToWorldCoordinates(new t.Point(0,0)),s=e.screenToWorldCoordinates(new t.Point(e.width,e.height));this._onScreenXStart=Math.max(Math.floor(i.x/this.cellWidth)-2,0),this._onScreenYStart=Math.max(Math.floor((i.y-this.y)/this.cellHeight),0),this._onScreenXEnd=Math.max(Math.floor(s.x/this.cellWidth),0),this._onScreenYEnd=Math.max(Math.floor((s.y-this.y)/this.cellHeight)+1,0)},i.prototype.draw=function(t){t.save(),t.translate(this.x,this.y);for(var e=this._onScreenXStart;Math.min(this._onScreenXEnd,this.cols)>e;e++)for(var i=this._onScreenYStart;Math.min(this._onScreenYEnd,this.rows)>i;i++){var s=this.getCell(e,i).spriteId;s>-1&&this.spriteSheet.getSprite(s).draw(t,e*this.cellWidth,i*this.cellHeight)}t.restore()},i.prototype.debugDraw=function(e){var i=this.cols*this.cellWidth,s=this.rows*this.cellHeight;e.save(),e.strokeStyle=""+t.Color.Red;for(var n=0;this.cols+1>n;n++)e.beginPath(),e.moveTo(this.x+n*this.cellWidth,this.y),e.lineTo(this.x+n*this.cellWidth,this.y+s),e.stroke();for(var o=0;this.rows+1>o;o++)e.beginPath(),e.moveTo(this.x,this.y+o*this.cellHeight),e.lineTo(this.x+i,this.y+o*this.cellHeight),e.stroke();this._collidingY>-1&&this._collidingX>-1&&(e.fillStyle=""+t.Color.Cyan,e.fillRect(this.x+this._collidingX*this.cellWidth,this.y+this._collidingY*this.cellHeight,this.cellWidth,this.cellHeight)),e.restore()},i}();t.CollisionMap=i})(ex||(ex={}));var ex;(function(t){var e=function(){function e(t,e,i,s){this.left=t,this.top=e,this.right=i,this.bottom=s}return e.prototype.getWidth=function(){return this.right-this.left},e.prototype.getHeight=function(){return this.bottom-this.top},e.prototype.contains=function(t){return this.left<=t.x&&this.top<=t.y&&this.bottom>=t.y&&this.right>=t.x},e.prototype.collides=function(i){if(i instanceof e){var s=i,n=new e(Math.min(this.left,s.left),Math.min(this.top,s.top),Math.max(this.right,s.right),Math.max(this.bottom,s.bottom));if(n.getWidth()<s.getWidth()+this.getWidth()&&n.getHeight()<s.getHeight()+this.getHeight()){var o=0;o=this.right>s.left&&this.right<s.right?s.left-this.right:s.right-this.left;var r=0;return r=this.top<s.bottom&&this.top>s.top?s.bottom-this.top:s.top-this.bottom,new t.Vector(o,r)}return null}return null},e}();t.BoundingBox=e})(ex||(ex={}));var ex;(function(t){var e=function(){function t(t,e){this.x=t,this.y=e}return t}();t.Overlap=e;var i=function(e){function i(){e.call(this),this.children=[],this.collisionMaps=[],this.killQueue=[],this.timers=[],this.cancelQueue=[],this._isInitialized=!1}return __extends(i,e),i.prototype.onActivate=function(){},i.prototype.onDeactivate=function(){},i.prototype.onInitialize=function(){},i.prototype.publish=function(t,e){this.children.forEach(function(i){i.triggerEvent(t,e)})},i.prototype.update=function(e,i){this._isInitialized||(this.onInitialize(e),this.eventDispatcher.publish("initialize",new t.InitializeEvent(e)),this._isInitialized=!0),this.collisionMaps.forEach(function(t){t.update(e,i)}),this.eventDispatcher.update();for(var s=0,n=0,s=this.children.length;s>n;n++)this.children[n].update(e,i);for(var o=0,r=0,s=this.killQueue.length;s>r;r++)o=this.children.indexOf(this.killQueue[r]),o>-1&&this.children.splice(o,1);this.killQueue.length=0;for(var h=0,s=this.cancelQueue.length;s>h;h++)this.removeTimer(this.cancelQueue[h]);this.cancelQueue.length=0,this.timers=this.timers.filter(function(t){return t.update(i),!t.complete})},i.prototype.draw=function(t,e){this.collisionMaps.forEach(function(i){i.draw(t,e)});for(var i,s=0,n=0,s=this.children.length;s>n;n++)i=this.children[n],this.children[n].draw(t,e)},i.prototype.debugDraw=function(t){this.collisionMaps.forEach(function(e){e.debugDraw(t)}),this.children.forEach(function(e){e.debugDraw(t)})},i.prototype.addChild=function(t){t.scene=this,this.children.push(t),t.parent=this.actor},i.prototype.addCollisionMap=function(t){this.collisionMaps.push(t)},i.prototype.removeCollisionMap=function(t){var e=this.collisionMaps.indexOf(t);e>-1&&this.collisionMaps.splice(e,1)},i.prototype.removeChild=function(t){this.killQueue.push(t),t.parent=null},i.prototype.addTimer=function(t){return this.timers.push(t),t.scene=this,t},i.prototype.removeTimer=function(t){var e=this.timers.indexOf(t);return-1!==e&&this.timers.splice(e,1),t},i.prototype.cancelTimer=function(t){return this.cancelQueue.push(t),t},i.prototype.isTimerActive=function(t){return this.timers.indexOf(t)>-1},i}(t.Util.Class);t.Scene=i,function(t){t[t.None=0]="None",t[t.Top=1]="Top",t[t.Bottom=2]="Bottom",t[t.Left=3]="Left",t[t.Right=4]="Right"}(t.Side||(t.Side={})),t.Side,function(t){t[t.PreventCollision=0]="PreventCollision",t[t.Passive=1]="Passive",t[t.Active=2]="Active",t[t.Elastic=3]="Elastic",t[t.Fixed=4]="Fixed"}(t.CollisionType||(t.CollisionType={})),t.CollisionType;var s=function(e){function s(s,n,o,r,h){e.call(this),this.x=0,this.y=0,this.height=0,this.width=0,this.rotation=0,this.rx=0,this.scaleX=1,this.scaleY=1,this.sx=0,this.sy=0,this.dx=0,this.dy=0,this.ax=0,this.ay=0,this.isOffScreen=!1,this.invisible=!1,this.opacity=1,this.previousOpacity=1,this.logger=t.Logger.getInstance(),this.scene=null,this.parent=null,this.collisionType=2,this.collisionGroups=[],this._collisionHandlers={},this._isInitialized=!1,this.frames={},this.currentDrawing=null,this.centerDrawingX=!1,this.centerDrawingY=!1,this._isKilled=!1,this.x=s||0,this.y=n||0,this.width=o||0,this.height=r||0,this.color=h,this.actionQueue=new t.Internal.Actions.ActionQueue(this),this.sceneNode=new i,this.sceneNode.actor=this}return __extends(s,e),s.prototype.onInitialize=function(){},s.prototype.kill=function(){this.scene?(this.scene.removeChild(this),this._isKilled=!0):this.logger.warn("Cannot kill actor, it was never added to the Scene")},s.prototype.addChild=function(t){t.collisionType=0,this.sceneNode.addChild(t)},s.prototype.removeChild=function(t){this.sceneNode.removeChild(t)},s.prototype.setDrawing=function(t){this.currentDrawing!=this.frames[t]&&this.frames[t].reset(),this.currentDrawing=this.frames[t]},s.prototype.addDrawing=function(t,e){this.frames[t]=e,this.currentDrawing||(this.currentDrawing=e)},s.prototype.triggerEvent=function(t,e){this.eventDispatcher.publish(t,e)},s.prototype.addCollisionGroup=function(t){this.collisionGroups.push(t)},s.prototype.removeCollisionGroup=function(t){var e=this.collisionGroups.indexOf(t);-1!==e&&this.collisionGroups.splice(e,1)},s.prototype.getCenter=function(){return new t.Vector(this.x+this.getWidth()/2,this.y+this.getHeight()/2)},s.prototype.getWidth=function(){return this.width*this.scaleX},s.prototype.setWidth=function(t){this.width=t/this.scaleX},s.prototype.getHeight=function(){return this.height*this.scaleY},s.prototype.setHeight=function(t){this.height=t/this.scaleY},s.prototype.setCenterDrawing=function(){this.centerDrawingY=!0,this.centerDrawingX=!0},s.prototype.getLeft=function(){return this.x},s.prototype.getRight=function(){return this.x+this.getWidth()},s.prototype.getTop=function(){return this.y},s.prototype.getBottom=function(){return this.y+this.getHeight()},s.prototype.getGlobalX=function(){for(var t,e=this.parent;e;)t=e,e=e.parent;return t?this.x+t.x:this.x},s.prototype.getGlobalY=function(){for(var t,e=this.parent;e;)t=e,e=e.parent;return t?this.y+t.y:this.y},s.prototype.getBounds=function(){return new t.BoundingBox(this.getGlobalX(),this.getGlobalY(),this.getGlobalX()+this.getWidth(),this.getGlobalY()+this.getHeight())},s.prototype.contains=function(e,i){return this.getBounds().contains(new t.Point(e,i))},s.prototype.getSideFromIntersect=function(t){return t?Math.abs(t.x)<Math.abs(t.y)?0>t.x?4:3:0>t.y?2:1:0},s.prototype.collidesWithSide=function(t){return this.getSideFromIntersect(this.collides(t))},s.prototype.collides=function(t){var e=this.getBounds(),i=t.getBounds(),s=e.collides(i);return s},s.prototype.onCollidesWith=function(t,e){this._collisionHandlers[t]||(this._collisionHandlers[t]=[]),this._collisionHandlers[t].push(e)},s.prototype.removeCollidesWith=function(t){this._collisionHandlers[t]=[]},s.prototype.within=function(t,e){return e>=Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))},s.prototype.clearActions=function(){this.actionQueue.clearActions()},s.prototype.moveTo=function(e,i,s){return this.actionQueue.add(new t.Internal.Actions.MoveTo(this,e,i,s)),this},s.prototype.moveBy=function(e,i,s){return this.actionQueue.add(new t.Internal.Actions.MoveBy(this,e,i,s)),this},s.prototype.rotateTo=function(e,i){return this.actionQueue.add(new t.Internal.Actions.RotateTo(this,e,i)),this},s.prototype.rotateBy=function(e,i){return this.actionQueue.add(new t.Internal.Actions.RotateBy(this,e,i)),this},s.prototype.scaleTo=function(e,i,s,n){return this.actionQueue.add(new t.Internal.Actions.ScaleTo(this,e,i,s,n)),this},s.prototype.scaleBy=function(e,i,s){return this.actionQueue.add(new t.Internal.Actions.ScaleBy(this,e,i,s)),this},s.prototype.blink=function(e,i,s){return this.actionQueue.add(new t.Internal.Actions.Blink(this,e,i,s)),this},s.prototype.fade=function(e,i){return this.actionQueue.add(new t.Internal.Actions.Fade(this,e,i)),this},s.prototype.delay=function(e){return this.actionQueue.add(new t.Internal.Actions.Delay(this,e)),this},s.prototype.die=function(){return this.actionQueue.add(new t.Internal.Actions.Die(this)),this},s.prototype.callMethod=function(e){return this.actionQueue.add(new t.Internal.Actions.CallMethod(this,e)),this},s.prototype.repeat=function(e){return e?(this.actionQueue.add(new t.Internal.Actions.Repeat(this,e,this.actionQueue.getActions())),this):(this.repeatForever(),this)},s.prototype.repeatForever=function(){return this.actionQueue.add(new t.Internal.Actions.RepeatForever(this,this.actionQueue.getActions())),this},s.prototype.follow=function(e,i){return void 0==i?this.actionQueue.add(new t.Internal.Actions.Follow(this,e)):this.actionQueue.add(new t.Internal.Actions.Follow(this,e,i)),this},s.prototype.meet=function(e,i){return void 0==i?this.actionQueue.add(new t.Internal.Actions.Meet(this,e)):this.actionQueue.add(new t.Internal.Actions.Meet(this,e,i)),this},s.prototype.update=function(e,i){var s=this;this._isInitialized||(this.onInitialize(e),this.eventDispatcher.publish("initialize",new t.InitializeEvent(e)),this._isInitialized=!0),this.sceneNode.update(e,i);var n=this.eventDispatcher;if(n.update(),this.actionQueue.update(i),this.x+=this.dx*i/1e3,this.y+=this.dy*i/1e3,this.dx+=this.ax*i/1e3,this.dy+=this.ay*i/1e3,this.rotation+=this.rx*i/1e3,this.scaleX+=this.sx*i/1e3,this.scaleY+=this.sy*i/1e3,0!==this.collisionType){for(var o=e.currentScene.children.filter(function(t){return!t._isKilled&&0!==t.collisionType&&s!==t}),r=0;o.length>r;r++){var h,a,c=o[r];(h=this.collides(c))&&(a=this.getSideFromIntersect(h),n.publish("collision",new t.CollisionEvent(this,c,a,h)),c.collisionGroups.forEach(function(t){s._collisionHandlers[t]&&s._collisionHandlers[t].forEach(function(t){t.call(s,c)})}),2!==this.collisionType&&3!==this.collisionType||1===c.collisionType||(Math.abs(h.y)<Math.abs(h.x)?this.y+=h.y:this.x+=h.x,3===this.collisionType&&(3===a?this.dx=Math.abs(this.dx):4===a?this.dx=-Math.abs(this.dx):1===a?this.dy=Math.abs(this.dy):2===a&&(this.dy=-Math.abs(this.dy)))))}for(var l=0;e.currentScene.collisionMaps.length>l;l++)for(var u,p=e.currentScene.collisionMaps[l],a=0,d=2,f=!1;(u=p.collides(this))&&!(0>d--);)a=this.getSideFromIntersect(u),n.publish("collision",new t.CollisionEvent(this,null,a,u)),2!==this.collisionType&&3!==this.collisionType||1===c.collisionType||(Math.abs(u.y)<Math.abs(u.x)?this.y+=u.y:this.x+=u.x,3!==this.collisionType||f||(f=!0,3===a?this.dx=Math.abs(this.dx):4===a?this.dx=-Math.abs(this.dx):1===a?this.dy=Math.abs(this.dy):2===a&&(this.dy=-Math.abs(this.dy))))}e.keys.forEach(function(e){n.publish(t.InputKey[e],new t.KeyEvent(e))}),e.clicks.forEach(function(e){s.contains(e.x,e.y)&&(n.publish(t.EventType[10],new t.Click(e.x,e.y,e.mouseEvent)),n.publish(t.EventType[3],new t.MouseDown(e.x,e.y,e.mouseEvent)))}),e.mouseMove.forEach(function(e){s.contains(e.x,e.y)&&n.publish(t.EventType[4],new t.MouseMove(e.x,e.y,e.mouseEvent))}),e.mouseUp.forEach(function(e){s.contains(e.x,e.y)&&n.publish(t.EventType[5],new t.MouseUp(e.x,e.y,e.mouseEvent))}),e.touchStart.forEach(function(e){s.contains(e.x,e.y)&&n.publish(t.EventType[6],new t.TouchStart(e.x,e.y))}),e.touchMove.forEach(function(e){s.contains(e.x,e.y)&&n.publish(t.EventType[7],new t.TouchMove(e.x,e.y))}),e.touchEnd.forEach(function(e){s.contains(e.x,e.y)&&n.publish(t.EventType[8],new t.TouchEnd(e.x,e.y))}),e.touchCancel.forEach(function(e){s.contains(e.x,e.y)&&n.publish(t.EventType[9],new t.TouchCancel(e.x,e.y))});var A=e.worldToScreenCoordinates(new t.Point(this.getGlobalX(),this.getGlobalY())),g=1;e.camera&&(g=e.camera.getZoom()),this.isOffScreen?A.x+this.getWidth()*g>0&&A.y+this.getHeight()*g>0&&A.x<e.width&&A.y<e.height&&(n.publish("enterviewport",new t.EnterViewPortEvent),this.isOffScreen=!1):(0>A.x+this.getWidth()*g||0>A.y+this.getHeight()*g||A.x>e.width||A.y>e.height)&&(n.publish("exitviewport",new t.ExitViewPortEvent),this.isOffScreen=!0),n.publish(t.EventType[16],new t.UpdateEvent(i))},s.prototype.draw=function(e,i){if(!this.isOffScreen){if(e.save(),e.translate(this.x,this.y),e.rotate(this.rotation),e.scale(this.scaleX,this.scaleY),this.previousOpacity!=this.opacity){for(var s in this.frames)this.frames[s].addEffect(new t.Effects.Opacity(this.opacity));this.previousOpacity=this.opacity}if(!this.invisible)if(this.currentDrawing){var n=0,o=0;this.centerDrawingX&&(n=(this.currentDrawing.width*this.currentDrawing.getScaleX()-this.width)/2),this.centerDrawingY&&(o=(this.currentDrawing.height*this.currentDrawing.getScaleY()-this.height)/2),this.currentDrawing.draw(e,-n,-o)}else e.fillStyle=this.color?""+this.color:""+new t.Color(0,0,0),e.fillRect(0,0,this.width,this.height);this.sceneNode.draw(e,i),e.restore()}},s.prototype.debugDraw=function(e){e.save(),e.translate(this.x,this.y),e.fillStyle=""+t.Color.Yellow,e.strokeStyle=""+t.Color.Yellow,e.beginPath(),e.rect(0,0,this.getWidth(),this.getHeight()),e.stroke(),this.sceneNode.debugDraw(e),e.restore()},s}(t.Util.Class);t.Actor=s,function(t){t[t.Left=0]="Left",t[t.Right=1]="Right",t[t.Center=2]="Center",t[t.Start=3]="Start",t[t.End=4]="End"}(t.TextAlign||(t.TextAlign={})),t.TextAlign,function(t){t[t.Top=0]="Top",t[t.Hanging=1]="Hanging",t[t.Middle=2]="Middle",t[t.Alphabetic=3]="Alphabetic",t[t.Ideographic=4]="Ideographic",t[t.Bottom=5]="Bottom"}(t.BaseAlign||(t.BaseAlign={})),t.BaseAlign;var n=function(e){function i(i,s,n,o,r){e.call(this,s,n),this.letterSpacing=0,this.caseInsensitive=!0,this._textShadowOn=!1,this._shadowOffsetX=0,this._shadowOffsetY=0,this._shadowColor=t.Color.Black.clone(),this._shadowColorDirty=!1,this._textSprites={},this._shadowSprites={},this._color=t.Color.Black.clone(),this.text=i||"",this.color=t.Color.Black.clone(),this.spriteFont=r,this.collisionType=0,this.font=o||"10px sans-serif",r&&(this._textSprites=r.getTextSprites())}return __extends(i,e),i.prototype.getTextWidth=function(t){var e=t.font;t.font=this.font;var i=t.measureText(this.text).width;return t.font=e,i},i.prototype._lookupTextAlign=function(t){switch(t){case 0:return"left";case 1:return"right";case 2:return"center";case 4:return"end";case 3:return"start";default:return"start"}},i.prototype._lookupBaseAlign=function(t){switch(t){case 3:return"alphabetic";case 5:return"bottom";case 1:return"hangin";case 4:return"ideographic";case 2:return"middle";case 0:return"top";default:return"alphabetic"}},i.prototype.setTextShadow=function(t,e,i){this._textShadowOn=!0,this._shadowOffsetX=t,this._shadowOffsetY=e,this._shadowColor=i.clone(),this._shadowColorDirty=!0;for(var s in this._textSprites)this._shadowSprites[s]=this._textSprites[s].clone()},i.prototype.clearTextShadow=function(){this._textShadowOn=!1,this._shadowOffsetX=0,this._shadowOffsetY=0,this._shadowColor=t.Color.Black.clone()},i.prototype.update=function(i,s){if(e.prototype.update.call(this,i,s),this.spriteFont&&this._color!==this.color)for(var n in this._textSprites)this._textSprites[n].clearEffects(),this._textSprites[n].addEffect(new t.Effects.Fill(this.color.clone())),this._color=this.color;if(this.spriteFont&&this._textShadowOn&&this._shadowColorDirty&&this._shadowColor){for(var n in this._shadowSprites)this._shadowSprites[n].clearEffects(),this._shadowSprites[n].addEffect(new t.Effects.Fill(this._shadowColor.clone()));this._shadowColorDirty=!1}},i.prototype.draw=function(t,i){t.save(),t.translate(this.x,this.y),t.scale(this.scaleX,this.scaleY),t.rotate(this.rotation),this._textShadowOn&&(t.save(),t.translate(this._shadowOffsetX,this._shadowOffsetY),this._fontDraw(t,i,this._shadowSprites),t.restore()),this._fontDraw(t,i,this._textSprites),e.prototype.draw.call(this,t,i),t.restore()},i.prototype._fontDraw=function(e,i,s){if(!this.invisible)if(this.spriteFont)for(var n=0,o=0;this.text.length>o;o++){var r=this.text[o];this.caseInsensitive&&(r=r.toLowerCase());try{var h=s[r];h.draw(e,n,0),n+=h.swidth+this.letterSpacing}catch(a){t.Logger.getInstance().error("SpriteFont Error drawing char "+r)}}else{var c=e.textAlign,l=e.textBaseline;e.textAlign=this._lookupTextAlign(this.textAlign),e.textBaseline=this._lookupBaseAlign(this.baseAlign),e.fillStyle=""+this.color,e.font=this.font,this.maxWidth?e.fillText(this.text,0,0,this.maxWidth):e.fillText(this.text,0,0),e.textAlign=c,e.textBaseline=l}},i.prototype.debugDraw=function(t){e.prototype.debugDraw.call(this,t)},i}(s);t.Label=n;var o=function(e){function i(i,s,n,o,r,h){e.call(this,i,s,n,o),this.action=function(){},this.repeats=1,this.target=null,this.repeats=h||this.repeats,this.action=r||this.action,this.collisionType=0,this.eventDispatcher=new t.EventDispatcher(this),this.actionQueue=new t.Internal.Actions.ActionQueue(this)}return __extends(i,e),i.prototype.update=function(t,e){var i=this.eventDispatcher;if(i.update(),this.actionQueue.update(e),this.x+=this.dx*e/1e3,this.y+=this.dy*e/1e3,this.rotation+=this.rx*e/1e3,this.scaleX+=this.sx*e/1e3,this.scaleY+=this.sy*e/1e3,this.target)this.collides(this.target)&&this.dispatchAction();else for(var s=0;t.currentScene.children.length>s;s++){var n=t.currentScene.children[s];n!==this&&0!==n.collisionType&&this.collides(n)&&this.dispatchAction()}0===this.repeats&&this.kill()},i.prototype.dispatchAction=function(){this.action.call(this),this.repeats--},i.prototype.draw=function(){},i.prototype.debugDraw=function(i){e.prototype.debugDraw.call(this,i),i.save(),i.translate(this.x,this.y),i.fillStyle=""+t.Color.Violet,i.strokeStyle=""+t.Color.Violet,i.fillText("Trigger",10,10),i.beginPath(),i.rect(0,0,this.getWidth(),this.getHeight()),i.stroke(),i.restore()},i}(s);t.Trigger=o})(ex||(ex={}));var ex;(function(t){(function(e){(function(e){var i=function(){function e(e,i,s,n){this._started=!1,this._stopped=!1,this.actor=e,this.end=new t.Vector(i,s),this.speed=n}return e.prototype.update=function(){this._started||(this._started=!0,this.start=new t.Vector(this.actor.x,this.actor.y),this.distance=this.start.distance(this.end),this.dir=this.end.minus(this.start).normalize());var e=this.dir.scale(this.speed);this.actor.dx=e.x,this.actor.dy=e.y,this.isComplete(this.actor)&&(this.actor.x=this.end.x,this.actor.y=this.end.y,this.actor.dy=0,this.actor.dx=0)},e.prototype.isComplete=function(e){return this._stopped||new t.Vector(e.x,e.y).distance(this.start)>=this.distance},e.prototype.stop=function(){this.actor.dy=0,this.actor.dx=0,this._stopped=!0},e.prototype.reset=function(){this._started=!1},e}();e.MoveTo=i;var s=function(){function e(e,i,s,n){if(this._started=!1,this._stopped=!1,this.actor=e,this.end=new t.Vector(i,s),0>=n)throw t.Logger.getInstance().error("Attempted to moveBy time less than or equal to zero : "+n),Error("Cannot move in time <= 0");
this.time=n}return e.prototype.update=function(){this._started||(this._started=!0,this.start=new t.Vector(this.actor.x,this.actor.y),this.distance=this.start.distance(this.end),this.dir=this.end.minus(this.start).normalize(),this.speed=this.distance/(this.time/1e3));var e=this.dir.scale(this.speed);this.actor.dx=e.x,this.actor.dy=e.y,this.isComplete(this.actor)&&(this.actor.x=this.end.x,this.actor.y=this.end.y,this.actor.dy=0,this.actor.dx=0)},e.prototype.isComplete=function(e){return this._stopped||new t.Vector(e.x,e.y).distance(this.start)>=this.distance},e.prototype.stop=function(){this.actor.dy=0,this.actor.dx=0,this._stopped=!0},e.prototype.reset=function(){this._started=!1},e}();e.MoveBy=s;var n=function(){function e(e,i,s){this._started=!1,this._stopped=!1,this.actor=e,this.actorToFollow=i,this.current=new t.Vector(this.actor.x,this.actor.y),this.end=new t.Vector(i.x,i.y),this.maximumDistance=void 0!=s?s:this.current.distance(this.end),this.speed=0}return e.prototype.update=function(){this._started||(this._started=!0,this.distanceBetween=this.current.distance(this.end),this.dir=this.end.minus(this.current).normalize());var t=Math.sqrt(Math.pow(this.actorToFollow.dx,2)+Math.pow(this.actorToFollow.dy,2));if(0!=t&&(this.speed=t),this.current.x=this.actor.x,this.current.y=this.actor.y,this.end.x=this.actorToFollow.x,this.end.y=this.actorToFollow.y,this.distanceBetween=this.current.distance(this.end),this.dir=this.end.minus(this.current).normalize(),this.distanceBetween>=this.maximumDistance){var e=this.dir.scale(this.speed);this.actor.dx=e.x,this.actor.dy=e.y}else this.actor.dx=0,this.actor.dy=0;this.isComplete(this.actor)&&(this.actor.x=this.end.x,this.actor.y=this.end.y,this.actor.dy=0,this.actor.dx=0)},e.prototype.stop=function(){this.actor.dy=0,this.actor.dx=0,this._stopped=!0},e.prototype.isComplete=function(){return this._stopped},e.prototype.reset=function(){this._started=!1},e}();e.Follow=n;var o=function(){function e(e,i,s){this._started=!1,this._stopped=!1,this._speedWasSpecified=!1,this.actor=e,this.actorToMeet=i,this.current=new t.Vector(this.actor.x,this.actor.y),this.end=new t.Vector(i.x,i.y),this.speed=s||0,void 0!=s&&(this._speedWasSpecified=!0)}return e.prototype.update=function(){this._started||(this._started=!0,this.distanceBetween=this.current.distance(this.end),this.dir=this.end.minus(this.current).normalize());var t=Math.sqrt(Math.pow(this.actorToMeet.dx,2)+Math.pow(this.actorToMeet.dy,2));0==t||this._speedWasSpecified||(this.speed=t),this.current.x=this.actor.x,this.current.y=this.actor.y,this.end.x=this.actorToMeet.x,this.end.y=this.actorToMeet.y,this.distanceBetween=this.current.distance(this.end),this.dir=this.end.minus(this.current).normalize();var e=this.dir.scale(this.speed);this.actor.dx=e.x,this.actor.dy=e.y,this.isComplete(this.actor)&&(this.actor.x=this.end.x,this.actor.y=this.end.y,this.actor.dy=0,this.actor.dx=0)},e.prototype.isComplete=function(){return this._stopped||1>=this.distanceBetween},e.prototype.stop=function(){this.actor.dy=0,this.actor.dx=0,this._stopped=!0},e.prototype.reset=function(){this._started=!1},e}();e.Meet=o;var r=function(){function t(t,e,i){this._started=!1,this._stopped=!1,this.actor=t,this.end=e,this.speed=i}return t.prototype.update=function(){this._started||(this._started=!0,this.start=this.actor.rotation,this.distance=Math.abs(this.end-this.start)),this.actor.rx=this.speed,this.isComplete(this.actor)&&(this.actor.rotation=this.end,this.actor.rx=0)},t.prototype.isComplete=function(){return this._stopped||Math.abs(this.actor.rotation-this.start)>=this.distance},t.prototype.stop=function(){this.actor.rx=0,this._stopped=!0},t.prototype.reset=function(){this._started=!1},t}();e.RotateTo=r;var h=function(){function t(t,e,i){this._started=!1,this._stopped=!1,this.actor=t,this.end=e,this.time=i,this.speed=1e3*((this.end-this.actor.rotation)/i)}return t.prototype.update=function(){this._started||(this._started=!0,this.start=this.actor.rotation,this.distance=Math.abs(this.end-this.start)),this.actor.rx=this.speed,this.isComplete(this.actor)&&(this.actor.rotation=this.end,this.actor.rx=0)},t.prototype.isComplete=function(){return this._stopped||Math.abs(this.actor.rotation-this.start)>=this.distance},t.prototype.stop=function(){this.actor.rx=0,this._stopped=!0},t.prototype.reset=function(){this._started=!1},t}();e.RotateBy=h;var a=function(){function t(t,e,i,s,n){this._started=!1,this._stopped=!1,this.actor=t,this.endX=e,this.endY=i,this.speedX=s,this.speedY=n}return t.prototype.update=function(){if(this._started||(this._started=!0,this.startX=this.actor.scaleX,this.startY=this.actor.scaleY,this.distanceX=Math.abs(this.endX-this.startX),this.distanceY=Math.abs(this.endY-this.startY)),Math.abs(this.actor.scaleX-this.startX)>=this.distanceX)this.actor.sx=0;else{var t=this.endY<this.startY?-1:1;this.actor.sx=this.speedX*t}if(Math.abs(this.actor.scaleY-this.startY)>=this.distanceY)this.actor.sy=0;else{var e=this.endY<this.startY?-1:1;this.actor.sy=this.speedY*e}this.isComplete(this.actor)&&(this.actor.scaleX=this.endX,this.actor.scaleY=this.endY,this.actor.sx=0,this.actor.sy=0)},t.prototype.isComplete=function(){return this._stopped||Math.abs(this.actor.scaleX-this.startX)>=this.distanceX&&Math.abs(this.actor.scaleY-this.startY)>=this.distanceY},t.prototype.stop=function(){this.actor.sx=0,this.actor.sy=0,this._stopped=!0},t.prototype.reset=function(){this._started=!1},t}();e.ScaleTo=a;var c=function(){function t(t,e,i,s){this._started=!1,this._stopped=!1,this.actor=t,this.endX=e,this.endY=i,this.time=s,this.speedX=1e3*((this.endX-this.actor.scaleX)/s),this.speedY=1e3*((this.endY-this.actor.scaleY)/s)}return t.prototype.update=function(){this._started||(this._started=!0,this.startX=this.actor.scaleX,this.startY=this.actor.scaleY,this.distanceX=Math.abs(this.endX-this.startX),this.distanceY=Math.abs(this.endY-this.startY));var t=this.endX<this.startX?-1:1,e=this.endY<this.startY?-1:1;this.actor.sx=this.speedX*t,this.actor.sy=this.speedY*e,this.isComplete(this.actor)&&(this.actor.scaleX=this.endX,this.actor.scaleY=this.endY,this.actor.sx=0,this.actor.sy=0)},t.prototype.isComplete=function(){return this._stopped||Math.abs(this.actor.scaleX-this.startX)>=this.distanceX&&Math.abs(this.actor.scaleY-this.startY)>=this.distanceY},t.prototype.stop=function(){this.actor.sx=0,this.actor.sy=0,this._stopped=!0},t.prototype.reset=function(){this._started=!1},t}();e.ScaleBy=c;var l=function(){function t(t,e){this.elapsedTime=0,this._started=!1,this._stopped=!1,this.actor=t,this.delay=e}return t.prototype.update=function(t){this._started||(this._started=!0),this.x=this.actor.x,this.y=this.actor.y,this.elapsedTime+=t},t.prototype.isComplete=function(){return this._stopped||this.elapsedTime>=this.delay},t.prototype.stop=function(){this._stopped=!0},t.prototype.reset=function(){this.elapsedTime=0,this._started=!1},t}();e.Delay=l;var u=function(){function t(t,e,i,s){this._started=!1,this.nextBlink=0,this.elapsedTime=0,this.isBlinking=!1,this._stopped=!1,this.actor=t,this.frequency=e,this.duration=i,this.numBlinks=Math.floor(e*i/1e3),this.blinkTime=s||200}return t.prototype.update=function(t){this._started||(this._started=!0,this.nextBlink+=this.duration/this.numBlinks/2),this.x=this.actor.x,this.y=this.actor.y,this.elapsedTime+=t,this.elapsedTime+this.blinkTime/2>this.nextBlink&&this.nextBlink>this.elapsedTime-this.blinkTime/2?(this.isBlinking=!0,this.actor.invisible=!0):(this.isBlinking&&(this.isBlinking=!1,this.nextBlink+=this.duration/this.numBlinks),this.actor.invisible=!1),this.isComplete(this.actor)&&(this.actor.invisible=!1)},t.prototype.isComplete=function(){return this._stopped||this.elapsedTime>=this.duration},t.prototype.stop=function(){this.actor.invisible=!1,this._stopped=!0},t.prototype.reset=function(){this._started=!1,this.nextBlink=0,this.elapsedTime=0,this.isBlinking=!1},t}();e.Blink=u;var p=function(){function e(t,e,i){this.multiplyer=1,this._started=!1,this._stopped=!1,this.actor=t,this.endOpacity=e,this.speed=i,t.opacity>e&&(this.multiplyer=-1)}return e.prototype.update=function(e){this._started||(this._started=!0),this.speed>0&&(this.actor.opacity+=this.multiplyer*Math.abs(this.actor.opacity-this.endOpacity)*e/this.speed),this.speed-=e,t.Logger.getInstance().debug("actor opacity: "+this.actor.opacity),this.isComplete(this.actor)&&(this.actor.opacity=this.endOpacity)},e.prototype.isComplete=function(){return this._stopped||.01>Math.abs(this.actor.opacity-this.endOpacity)},e.prototype.stop=function(){this._stopped=!0},e.prototype.reset=function(){this._started=!1},e}();e.Fade=p;var d=function(){function t(t){this._started=!1,this._stopped=!1,this.actor=t}return t.prototype.update=function(){this.actor.actionQueue.clearActions(),this.actor.kill(),this._stopped=!0},t.prototype.isComplete=function(){return this._stopped},t.prototype.stop=function(){},t.prototype.reset=function(){},t}();e.Die=d;var f=function(){function t(t,e){this._method=null,this._actor=null,this._hasBeenCalled=!1,this._actor=t,this._method=e}return t.prototype.update=function(){this._method.call(this._actor),this._hasBeenCalled=!0},t.prototype.isComplete=function(){return this._hasBeenCalled},t.prototype.reset=function(){this._hasBeenCalled=!1},t.prototype.stop=function(){this._hasBeenCalled=!0},t}();e.CallMethod=f;var A=function(){function t(t,e,i){var s=this;this._stopped=!1,this.actor=t,this.actionQueue=new y(t),this.repeat=e,this.originalRepeat=e,i.forEach(function(t){t.reset(),s.actionQueue.add(t)})}return t.prototype.update=function(t){this.x=this.actor.x,this.y=this.actor.y,this.actionQueue.hasNext()||(this.actionQueue.reset(),this.repeat--),this.actionQueue.update(t)},t.prototype.isComplete=function(){return this._stopped||0>=this.repeat},t.prototype.stop=function(){this._stopped=!0},t.prototype.reset=function(){this.repeat=this.originalRepeat},t}();e.Repeat=A;var g=function(){function t(t,e){var i=this;this._stopped=!1,this.actor=t,this.actionQueue=new y(t),e.forEach(function(t){t.reset(),i.actionQueue.add(t)})}return t.prototype.update=function(t){this.x=this.actor.x,this.y=this.actor.y,this._stopped||(this.actionQueue.hasNext()||this.actionQueue.reset(),this.actionQueue.update(t))},t.prototype.isComplete=function(){return this._stopped},t.prototype.stop=function(){this._stopped=!0,this.actionQueue.clearActions()},t.prototype.reset=function(){},t}();e.RepeatForever=g;var y=function(){function t(t){this._actions=[],this._completedActions=[],this.actor=t}return t.prototype.add=function(t){this._actions.push(t)},t.prototype.remove=function(t){var e=this._actions.indexOf(t);this._actions.splice(e,1)},t.prototype.clearActions=function(){this._actions.length=0,this._completedActions.length=0,this._currentAction.stop()},t.prototype.getActions=function(){return this._actions.concat(this._completedActions)},t.prototype.hasNext=function(){return this._actions.length>0},t.prototype.reset=function(){this._actions=this.getActions(),this._actions.forEach(function(t){t.reset()}),this._completedActions=[]},t.prototype.update=function(t){this._actions.length>0&&(this._currentAction=this._actions[0],this._currentAction.update(t),this._currentAction.isComplete(this.actor)&&this._completedActions.push(this._actions.shift()))},t}();e.ActionQueue=y})(e.Actions||(e.Actions={})),e.Actions})(t.Internal||(t.Internal={})),t.Internal})(ex||(ex={}));var ex;(function(t){(function(t){t[t.Circle=0]="Circle",t[t.Rectangle=1]="Rectangle"})(t.EmitterType||(t.EmitterType={})),t.EmitterType;var e=function(){function e(e,i,s,n,o,r,h,a,c,l){this.position=new t.Vector(0,0),this.velocity=new t.Vector(0,0),this.acceleration=new t.Vector(0,0),this.focus=null,this.focusAccel=0,this.opacity=1,this.beginColor=t.Color.White.clone(),this.endColor=t.Color.White.clone(),this.life=300,this.fadeFlag=!1,this.rRate=1,this.gRate=1,this.bRate=1,this.aRate=0,this.currentColor=t.Color.White.clone(),this.emitter=null,this.particleSize=5,this.particleSprite=null,this.sizeRate=0,this.elapsedMultiplier=0,this.emitter=e,this.life=i||this.life,this.opacity=s||this.opacity,this.endColor=o||this.endColor.clone(),this.beginColor=n||this.beginColor.clone(),this.currentColor=this.beginColor.clone(),this.position=r||this.position,this.velocity=h||this.velocity,this.acceleration=a||this.acceleration,this.rRate=(this.endColor.r-this.beginColor.r)/this.life,this.gRate=(this.endColor.g-this.beginColor.g)/this.life,this.bRate=(this.endColor.b-this.beginColor.b)/this.life,this.aRate=this.opacity/this.life,this.startSize=c||0,this.endSize=l||0,this.endSize>0&&this.startSize>0&&(this.sizeRate=(this.endSize-this.startSize)/this.life,this.particleSize=this.startSize)}return e.prototype.kill=function(){this.emitter.removeParticle(this)},e.prototype.update=function(e){if(this.life=this.life-e,this.elapsedMultiplier=this.elapsedMultiplier+e,0>this.life&&this.kill(),this.fadeFlag&&(this.opacity=t.Util.clamp(this.aRate*this.life,1e-4,1)),this.startSize>0&&this.endSize>0&&(this.particleSize=t.Util.clamp(this.sizeRate*e+this.particleSize,Math.min(this.startSize,this.endSize),Math.max(this.startSize,this.endSize))),this.currentColor.r=t.Util.clamp(this.currentColor.r+this.rRate*e,0,255),this.currentColor.g=t.Util.clamp(this.currentColor.g+this.gRate*e,0,255),this.currentColor.b=t.Util.clamp(this.currentColor.b+this.bRate*e,0,255),this.currentColor.a=t.Util.clamp(this.opacity,1e-4,1),this.focus){var i=this.focus.minus(this.position).normalize().scale(this.focusAccel).scale(e/1e3);this.velocity=this.velocity.add(i)}else this.velocity=this.velocity.add(this.acceleration.scale(e/1e3));this.position=this.position.add(this.velocity.scale(e/1e3))},e.prototype.draw=function(e){return this.particleSprite?(this.particleSprite.draw(e,this.position.x,this.position.y),void 0):(this.currentColor.a=t.Util.clamp(this.opacity,1e-4,1),e.fillStyle=""+this.currentColor,e.beginPath(),e.arc(this.position.x,this.position.y,this.particleSize,0,2*Math.PI),e.fill(),e.closePath(),void 0)},e}();t.Particle=e;var i=function(i){function s(e,s,n,o){i.call(this,e,s,n,o,t.Color.White),this.numParticles=0,this.isEmitting=!0,this.particles=null,this.deadParticles=null,this.minVel=0,this.maxVel=0,this.acceleration=new t.Vector(0,0),this.minAngle=0,this.maxAngle=0,this.emitRate=1,this.particleLife=2e3,this.opacity=1,this.fadeFlag=!1,this.focus=null,this.focusAccel=1,this.startSize=null,this.endSize=null,this.minSize=5,this.maxSize=5,this.beginColor=t.Color.White,this.endColor=t.Color.White,this.particleSprite=null,this.emitterType=1,this.radius=0,this.collisionType=0,this.particles=new t.Util.Collection,this.deadParticles=new t.Util.Collection}return __extends(s,i),s.prototype.removeParticle=function(t){this.deadParticles.push(t)},s.prototype.emit=function(t){for(var e=0;t>e;e++)this.particles.push(this.createParticle())},s.prototype.clearParticles=function(){this.particles.clear()},s.prototype.createParticle=function(){var i=0,s=0,n=t.Util.randomInRange(this.minAngle,this.maxAngle),o=t.Util.randomInRange(this.minVel,this.maxVel),r=this.startSize||t.Util.randomInRange(this.minSize,this.maxSize),h=o*Math.cos(n),a=o*Math.sin(n);if(1===this.emitterType)i=t.Util.randomInRange(this.x,this.x+this.getWidth()),s=t.Util.randomInRange(this.y,this.y+this.getHeight());else if(0===this.emitterType){var c=t.Util.randomInRange(0,this.radius);i=c*Math.cos(n)+this.x,s=c*Math.sin(n)+this.y}var l=new e(this,this.particleLife,this.opacity,this.beginColor,this.endColor,new t.Vector(i,s),new t.Vector(h,a),this.acceleration,this.startSize,this.endSize);return l.fadeFlag=this.fadeFlag,l.particleSize=r,l.particleSprite=this.particleSprite,this.focus&&(l.focus=this.focus.add(new t.Vector(this.x,this.y)),l.focusAccel=this.focusAccel),l},s.prototype.update=function(t,e){var s=this;if(i.prototype.update.call(this,t,e),this.isEmitting){var n=Math.ceil(this.emitRate*e/1e3);this.emit(n)}this.particles.forEach(function(t){t.update(e)}),this.deadParticles.forEach(function(t){s.particles.removeElement(t)}),this.deadParticles.clear()},s.prototype.draw=function(t){this.particles.forEach(function(e){e.draw(t)})},s.prototype.debugDraw=function(e){i.prototype.debugDraw.call(this,e),e.fillStyle=""+t.Color.Black,e.fillText("Particles: "+this.particles.count(),this.x,this.y+20),this.focus&&(e.fillRect(this.focus.x+this.x,this.focus.y+this.y,3,3),t.Util.drawLine(e,"yellow",this.focus.x+this.x,this.focus.y+this.y,i.prototype.getCenter.call(this).x,i.prototype.getCenter.call(this).y),e.fillText("Focus",this.focus.x+this.x,this.focus.y+this.y))},s}(t.Actor);t.ParticleEmitter=i})(ex||(ex={}));var ex;(function(t){(function(e){var i=function(){function e(e,i){this.log=t.Logger.getInstance(),this.onload=function(){},this.onprogress=function(){},this.onerror=function(){},window.AudioContext?(this.log.debug("Using new Web Audio Api for "+e),this.soundImpl=new o(e,i)):(this.log.debug("Falling back to Audio Element for "+e),this.soundImpl=new s(e,i))}return e.prototype.setVolume=function(t){this.soundImpl.setVolume(t)},e.prototype.setLoop=function(t){this.soundImpl.setLoop(t)},e.prototype.load=function(){this.soundImpl.onload=this.onload,this.soundImpl.onprogress=this.onprogress,this.soundImpl.onerror=this.onerror,this.soundImpl.load()},e.prototype.play=function(){this.soundImpl.play()},e.prototype.stop=function(){this.soundImpl.stop()},e}();e.FallbackAudio=i;var s=function(){function e(e,i){var s=this;this.path=e,this.audioElements=Array(5),this._loadedAudio=null,this.isLoaded=!1,this.index=0,this.log=t.Logger.getInstance(),this.onload=function(){},this.onprogress=function(){},this.onerror=function(){};for(var n=0;this.audioElements.length>n;n++)(function(t){s.audioElements[t]=new Audio})(n);this.setVolume(i||1)}return e.prototype.audioLoaded=function(){this.isLoaded=!0},e.prototype.setVolume=function(t){this.audioElements.forEach(function(e){e.volume=t})},e.prototype.setLoop=function(t){this.audioElements.forEach(function(e){e.loop=t})},e.prototype.load=function(){var t=this,e=new XMLHttpRequest;e.open("GET",this.path,!0),e.responseType="blob",e.onprogress=this.onprogress,e.onerror=this.onerror,e.onload=function(i){return 200!==e.status?(t.log.error("Failed to load audio resource ",t.path," server responded with error code",e.status),t.onerror(e.response),t.isLoaded=!1,void 0):(t._loadedAudio=URL.createObjectURL(e.response),t.audioElements.forEach(function(e){e.src=t._loadedAudio}),t.onload(i),void 0)},e.send()},e.prototype.play=function(){this.audioElements[this.index].load(),this.audioElements[this.index].play(),this.index=(this.index+1)%this.audioElements.length},e.prototype.stop=function(){this.audioElements.forEach(function(t){t.pause()})},e}();if(e.AudioTag=s,window.AudioContext)var n=new window.AudioContext;var o=function(){function e(e,i){this.context=n,this.volume=this.context.createGain(),this.buffer=null,this.sound=null,this.path="",this.isLoaded=!1,this.loop=!1,this.logger=t.Logger.getInstance(),this.onload=function(){},this.onprogress=function(){},this.onerror=function(){},this.path=e,this.volume.gain.value=i?i:1}return e.prototype.setVolume=function(t){this.volume.gain.value=t},e.prototype.load=function(){var t=this,e=new XMLHttpRequest;e.open("GET",this.path),e.responseType="arraybuffer",e.onprogress=this.onprogress,e.onerror=this.onerror,e.onload=function(){return 200!==e.status?(t.logger.error("Failed to load audio resource ",t.path," server responded with error code",e.status),t.onerror(e.response),t.isLoaded=!1,void 0):(t.context.decodeAudioData(e.response,function(e){t.buffer=e,t.isLoaded=!0,t.onload(t)},function(){t.logger.error("Unable to decode "+t.path+" this browser may not fully support this format, or the file may be corrupt, "+"if this is an mp3 try removing id3 tags and album art from the file."),t.isLoaded=!1,t.onload(t)}),void 0)};try{e.send()}catch(i){console.error("Error loading sound! If this is a cross origin error, you must host your sound with your html and javascript.")}},e.prototype.setLoop=function(t){this.loop=t},e.prototype.play=function(){this.isLoaded&&(this.sound=this.context.createBufferSource(),this.sound.buffer=this.buffer,this.sound.loop=this.loop,this.sound.connect(this.volume),this.volume.connect(this.context.destination),this.sound.start(0))},e.prototype.stop=function(){if(this.sound)try{this.sound.stop(0)}catch(t){this.logger.warn("The sound clip",this.path,"has already been stopped!")}},e}();e.WebAudio=o})(t.Internal||(t.Internal={})),t.Internal})(ex||(ex={}));var ex;(function(t){(function(t){t[t.Resolved=0]="Resolved",t[t.Rejected=1]="Rejected",t[t.Pending=2]="Pending"})(t.PromiseState||(t.PromiseState={})),t.PromiseState;var e=function(){function e(){this._state=2,this.successCallbacks=[],this.rejectCallback=function(){},this.logger=t.Logger.getInstance()}return e.wrap=function(t){var i=(new e).resolve(t);return i},e.prototype.then=function(t,e){if(t&&(this.successCallbacks.push(t),0===this.state()))try{t.call(this,this.value)}catch(i){this.handleError(i)}if(e&&(this.rejectCallback=e,1===this.state()))try{e.call(this,this.value)}catch(i){this.handleError(i)}return this},e.prototype.error=function(t){return t&&(this.errorCallback=t),this},e.prototype.resolve=function(t){var e=this;if(2!==this._state)throw Error("Cannot resolve a promise that is not in a pending state!");this.value=t;try{this._state=0,this.successCallbacks.forEach(function(t){t.call(e,e.value)})}catch(i){this.handleError(i)}return this},e.prototype.reject=function(t){if(2!==this._state)throw Error("Cannot reject a promise that is not in a pending state!");this.value=t;try{this._state=1,this.rejectCallback.call(this,this.value)}catch(e){this.handleError(e)}return this},e.prototype.state=function(){return this._state},e.prototype.handleError=function(t){this.errorCallback&&this.errorCallback.call(this,t)},e}();t.Promise=e})(ex||(ex={}));var ex;(function(t){var e=function(){function e(e){this.path=e,this.logger=t.Logger.getInstance(),this.onprogress=function(){},this.oncomplete=function(){},this.onerror=function(){}}return e.prototype._start=function(){this.logger.debug("Started loading image "+this.path)},e.prototype.isLoaded=function(){return!!this.image&&!!this.image.src},e.prototype.load=function(){var e=this,i=new t.Promise;this.image=new Image;var s=new XMLHttpRequest;return s.open("GET",this.path,!0),s.responseType="blob",s.onloadstart=function(t){e._start(t)},s.onprogress=this.onprogress,s.onerror=this.onerror,s.onload=function(){return 200!==s.status?(e.logger.error("Failed to load image resource ",e.path," server responded with error code",s.status),e.onerror(s.response),i.resolve(s.response),void 0):(e.image.src=URL.createObjectURL(s.response),e.oncomplete(),e.logger.debug("Completed loading image",e.path),i.resolve(e.image),void 0)},s.overrideMimeType&&s.overrideMimeType("text/plain; charset=x-user-defined"),s.send(),i},e}();t.Texture=e;var i=function(){function e(){for(var i=[],s=0;arguments.length-0>s;s++)i[s]=arguments[s+0];this.logger=t.Logger.getInstance(),this.onprogress=function(){},this.oncomplete=function(){},this.onerror=function(){},this.onload=function(){},this._isLoaded=!1,this._selectedFile="",this._selectedFile="";for(var n=0;i.length>n;n++)if(e.canPlayFile(i[n])){this._selectedFile=i[n];break}this._selectedFile||(this.logger.warn("This browser does not support any of the files specified"),this._selectedFile=i[0]),this.sound=new t.Internal.FallbackAudio(this._selectedFile,1)}return e.canPlayFile=function(t){var e=new Audio,i=/.*\.([A-Za-z0-9]+)$/,s=t.match(i)[1];return e.canPlayType("audio/"+s)?!0:!1},e.prototype.setVolume=function(t){this.sound&&this.sound.setVolume(t)},e.prototype.setLoop=function(t){this.sound&&this.sound.setLoop(t)},e.prototype.play=function(){this.sound&&this.sound.play()},e.prototype.stop=function(){this.sound&&this.sound.stop()},e.prototype.isLoaded=function(){return this._isLoaded},e.prototype.load=function(){var e=this,i=new t.Promise;return this.logger.debug("Started loading sound",this._selectedFile),this.sound.onprogress=this.onprogress,this.sound.onload=function(){e.oncomplete(),e._isLoaded=!0,e.logger.debug("Completed loading sound",e._selectedFile),i.resolve(e.sound)},this.sound.onerror=function(t){e.onerror(t),i.resolve(t)},this.sound.load(),i},e}();t.Sound=i;var s=function(){function e(t){this.resourceList=[],this.index=0,this.resourceCount=0,this.numLoaded=0,this.progressCounts={},this.totalCounts={},this.onprogress=function(){},this.oncomplete=function(){},this.onerror=function(){},t&&this.addResources(t)}return e.prototype.addResource=function(t){var e=this.index++;this.resourceList.push(t),this.progressCounts[e]=0,this.totalCounts[e]=1,this.resourceCount++},e.prototype.addResources=function(t){var e=this;t.forEach(function(t){e.addResource(t)})},e.prototype.sumCounts=function(t){var e=0;for(var i in t)e+=0|t[i];return e},e.prototype.isLoaded=function(){return this.numLoaded===this.resourceCount},e.prototype.load=function(){function e(t,i){t[i]&&t[i].load().then(function(){e(t,i+1)})}var i=new t.Promise,s=this;if(0===this.resourceList.length)return s.oncomplete.call(s),i;var n=Array(this.resourceList.length),o=this.resourceList.length;return this.resourceList.forEach(function(t,e){t.onprogress=function(t){var i=t.total,r=t.loaded;n[e]={loaded:r/i*(100/o),total:100};var h=n.reduce(function(t,e){return{loaded:t.loaded+e.loaded,total:100}},{loaded:0,total:100});s.onprogress.call(s,h)},t.oncomplete=t.onerror=function(){s.numLoaded++,s.numLoaded===s.resourceCount&&(s.onprogress.call(s,{loaded:100,total:100}),s.oncomplete.call(s),i.resolve())}}),e(this.resourceList,0),i},e}();t.Loader=s})(ex||(ex={}));var ex;(function(t){var e=function(){function t(t,e,i,n,o){this.image=t,this.columns=e,this.rows=i,this.sprites=[],this.internalImage=t.image,this.sprites=Array(e*i);var r=0,h=0;for(r=0;i>r;r++)for(h=0;e>h;h++)this.sprites[h+r*e]=new s(this.image,h*n,r*o,n,o)}return t.prototype.getAnimationByIndices=function(t,e,i){var s=this.sprites.filter(function(t,i){return e.indexOf(i)>-1});return s=s.map(function(t){return t.clone()}),new n(t,s,i)},t.prototype.getAnimationBetween=function(t,e,i,s){var o=this.sprites.slice(e,i);return o=o.map(function(t){return t.clone()}),new n(t,o,s)},t.prototype.getAnimationForAll=function(t,e){var i=this.sprites.map(function(t){return t.clone()});return new n(t,i,e)},t.prototype.getSprite=function(t){return t>=0&&this.sprites.length>t?this.sprites[t]:void 0},t}();t.SpriteSheet=e;var i=function(e){function i(i,s,n,o,r,h,a){e.call(this,i,o,r,h,a),this.image=i,this.alphabet=s,this.caseInsensitive=n,this.spriteLookup={},this.colorLookup={},this._currentColor=t.Color.Black}return __extends(i,e),i.prototype.getTextSprites=function(){for(var t={},e=0;this.alphabet.length>e;e++){var i=this.alphabet[e];this.caseInsensitive&&(i=i.toLowerCase()),t[i]=this.sprites[e].clone()}return t},i}(e);t.SpriteFont=i,function(t){var e=function(){function t(){}return t.prototype.updatePixel=function(t,e,i){var s=4*(t+e*i.width),n=i.data,o=(n[s+0]+n[s+1]+n[s+2])/3;n[s+0]=o,n[s+1]=o,n[s+2]=o},t}();t.Grayscale=e;var i=function(){function t(){}return t.prototype.updatePixel=function(t,e,i){var s=4*(t+e*i.width),n=i.data;n[s+0]=255-n[s+0],n[s+1]=255-n[s+1],n[s+2]=255-n[s+2]},t}();t.Invert=i;var s=function(){function t(t){this.opacity=t}return t.prototype.updatePixel=function(t,e,i){var s=4*(t+e*i.width),n=i.data;0!==n[s+3]&&(n[s+3]=Math.round(255*this.opacity))},t}();t.Opacity=s;var n=function(){function t(t){this.color=t}return t.prototype.updatePixel=function(t,e,i){var s=4*(t+e*i.width),n=i.data;0!==n[s+3]&&(n[s+0]=(n[s+0]+this.color.r)/2,n[s+1]=(n[s+1]+this.color.g)/2,n[s+2]=(n[s+2]+this.color.b)/2)},t}();t.Colorize=n;var o=function(){function t(t){this.color=t}return t.prototype.updatePixel=function(t,e,i){var s=4*(t+e*i.width),n=i.data;0!==n[s+3]&&(n[s+0]=this.color.r,n[s+1]=this.color.g,n[s+2]=this.color.b)},t}();t.Fill=o}(t.Effects||(t.Effects={})),t.Effects;var s=function(){function e(e,i,s,n,o){this.sx=i,this.sy=s,this.swidth=n,this.sheight=o,this.scaleX=1,this.scaleY=1,this.rotation=0,this.transformPoint=new t.Point(0,0),this.flipVertical=!1,this.flipHorizontal=!1,this.width=0,this.height=0,this.effects=[],this.internalImage=new Image,this.spriteCanvas=null,this.spriteCtx=null,this.pixelData=null,this.pixelsLoaded=!1,this.dirtyEffect=!1,this.texture=e,this.spriteCanvas=document.createElement("canvas"),this.spriteCanvas.width=n,this.spriteCanvas.height=o,this.spriteCtx=this.spriteCanvas.getContext("2d"),this.width=n,this.height=o}return e.prototype.loadPixels=function(){this.texture.isLoaded()&&!this.pixelsLoaded&&(this.spriteCtx.drawImage(this.texture.image,this.sx,this.sy,this.swidth,this.sheight,0,0,this.swidth,this.sheight),this.internalImage.src=this.spriteCanvas.toDataURL("image/png"),this.pixelsLoaded=!0)},e.prototype.addEffect=function(t){this.effects.push(t),this.texture.isLoaded()&&this.pixelsLoaded?this.applyEffects():this.dirtyEffect=!0},e.prototype.applyEffects=function(){var t=this;this.spriteCtx.clearRect(0,0,this.swidth,this.sheight),this.spriteCtx.drawImage(this.texture.image,this.sx,this.sy,this.swidth,this.sheight,0,0,this.swidth,this.sheight),this.pixelData=this.spriteCtx.getImageData(0,0,this.swidth,this.sheight),this.effects.forEach(function(e){for(var i=0;t.sheight>i;i++)for(var s=0;t.swidth>s;s++)e.updatePixel(s,i,t.pixelData)}),this.spriteCtx.clearRect(0,0,this.swidth,this.sheight),this.spriteCtx.putImageData(this.pixelData,0,0),this.internalImage.src=this.spriteCanvas.toDataURL("image/png")},e.prototype.clearEffects=function(){this.effects.length=0,this.applyEffects()},e.prototype.transformAboutPoint=function(t){this.transformPoint=t},e.prototype.setRotation=function(t){this.rotation=t},e.prototype.getRotation=function(){return this.rotation},e.prototype.setScaleX=function(t){this.scaleX=t},e.prototype.setScaleY=function(t){this.scaleY=t},e.prototype.getScaleX=function(){return this.scaleX},e.prototype.getScaleY=function(){return this.scaleY},e.prototype.reset=function(){},e.prototype.draw=function(t,e,i){this.loadPixels(),this.dirtyEffect&&(this.applyEffects(),this.dirtyEffect=!1),t.save(),t.translate(e+this.transformPoint.x,i+this.transformPoint.y),t.rotate(this.rotation),this.flipHorizontal&&(t.translate(this.swidth,0),t.scale(-1,1)),this.flipVertical&&(t.translate(0,this.sheight),t.scale(1,-1)),this.internalImage&&t.drawImage(this.internalImage,0,0,this.swidth,this.sheight,-this.transformPoint.x,-this.transformPoint.y,this.swidth*this.scaleX,this.sheight*this.scaleY),t.restore()},e.prototype.clone=function(){var t=new e(this.texture,this.sx,this.sy,this.swidth,this.sheight);return t.scaleX=this.scaleX,t.scaleY=this.scaleY,t.rotation=this.rotation,t.flipHorizontal=this.flipHorizontal,t.flipVertical=this.flipVertical,this.effects.forEach(function(e){t.addEffect(e)}),t},e}();t.Sprite=s;var n=function(){function e(t,e,i,s){this.currIndex=0,this.oldTime=Date.now(),this.rotation=0,this.scaleX=1,this.scaleY=1,this.loop=!1,this.freezeFrame=-1,this.flipVertical=!1,this.flipHorizontal=!1,this.width=0,this.height=0,this.sprites=e,this.speed=i,this.engine=t,null!=s&&(this.loop=s),this.height=e[0]?e[0].height:0,this.width=e[0]?e[0].width:0}return e.prototype.addEffect=function(t){for(var e in this.sprites)this.sprites[e].addEffect(t)},e.prototype.clearEffects=function(){for(var t in this.sprites)this.sprites[t].clearEffects()},e.prototype.transformAboutPoint=function(t){for(var e in this.sprites)this.sprites[e].transformAboutPoint(t)},e.prototype.setRotation=function(t){this.rotation=t;for(var e in this.sprites)this.sprites[e].setRotation(t)},e.prototype.getRotation=function(){return this.rotation},e.prototype.setScaleX=function(t){this.scaleX=t;for(var e in this.sprites)this.sprites[e].setScaleX(t)},e.prototype.setScaleY=function(t){this.scaleY=t;for(var e in this.sprites)this.sprites[e].setScaleY(t)},e.prototype.getScaleX=function(){return this.scaleX},e.prototype.getScaleY=function(){return this.scaleY},e.prototype.reset=function(){this.currIndex=0
},e.prototype.isDone=function(){return!this.loop&&this.currIndex>=this.sprites.length},e.prototype.tick=function(){var t=Date.now();t-this.oldTime>this.speed&&(this.currIndex=this.loop?(this.currIndex+1)%this.sprites.length:this.currIndex+1,this.oldTime=t)},e.prototype.draw=function(e,i,s){if(this.tick(),this.currIndex<this.sprites.length){var n=this.sprites[this.currIndex];this.flipVertical&&(n.flipVertical=this.flipVertical),this.flipHorizontal&&(n.flipHorizontal=this.flipHorizontal),n.draw(e,i,s)}if(-1!==this.freezeFrame&&this.currIndex>=this.sprites.length){var n=this.sprites[t.Util.clamp(this.freezeFrame,0,this.sprites.length-1)];n.draw(e,i,s)}},e.prototype.play=function(t,e){this.reset(),this.engine.playAnimation(this,t,e)},e}();t.Animation=n;var o=function(){function e(e){this.lineWidth=5,this.filled=!1,this.points=[],this.transformationPoint=new t.Point(0,0),this.rotation=0,this.scaleX=1,this.scaleY=1,this.points=e;var i=this.points.reduce(function(t,e){return Math.min(t,e.x)},0),s=this.points.reduce(function(t,e){return Math.max(t,e.x)},0);this.width=s-i;var n=this.points.reduce(function(t,e){return Math.min(t,e.y)},0),o=this.points.reduce(function(t,e){return Math.max(t,e.y)},0);this.height=o-n}return e.prototype.addEffect=function(){},e.prototype.clearEffects=function(){},e.prototype.transformAboutPoint=function(t){this.transformationPoint=t},e.prototype.setScaleX=function(t){this.scaleX=t},e.prototype.setScaleY=function(t){this.scaleY=t},e.prototype.getScaleX=function(){return this.scaleX},e.prototype.getScaleY=function(){return this.scaleY},e.prototype.setRotation=function(t){this.rotation=t},e.prototype.getRotation=function(){return this.rotation},e.prototype.reset=function(){},e.prototype.draw=function(t,e,i){t.save(),t.translate(e+this.transformationPoint.x,i+this.transformationPoint.y),t.scale(this.scaleX,this.scaleY),t.rotate(this.rotation),t.beginPath(),t.lineWidth=this.lineWidth;var s=this.points[0];t.moveTo(s.x,s.y),this.points.forEach(function(e){t.lineTo(e.x,e.y)}),t.lineTo(s.x,s.y),t.closePath(),this.filled&&(t.fillStyle=""+this.fillColor,t.fill()),t.strokeStyle=""+this.lineColor,this.flipHorizontal&&(t.translate(this.width,0),t.scale(-1,1)),this.flipVertical&&(t.translate(0,this.height),t.scale(1,-1)),t.stroke(),t.restore()},e}();t.Polygon=o})(ex||(ex={}));var ex;(function(t){var e=function(){function e(e){this.focus=new t.Point(0,0),this.isShaking=!1,this.shakeMagnitudeX=0,this.shakeMagnitudeY=0,this.shakeDuration=0,this.elapsedShakeTime=0,this.isZooming=!1,this.currentZoomScale=1,this.maxZoomScale=1,this.zoomDuration=0,this.elapsedZoomTime=0,this.zoomIncrement=.01,this.engine=e}return e.prototype.setActorToFollow=function(t){this.follow=t},e.prototype.getFocus=function(){return this.follow?new t.Point(0,0):this.focus},e.prototype.setFocus=function(t,e){this.follow||(this.focus.x=t,this.focus.y=e)},e.prototype.shake=function(t,e,i){this.isShaking=!0,this.shakeMagnitudeX=t,this.shakeMagnitudeY=e,this.shakeDuration=i},e.prototype.zoom=function(t,e){this.isZooming=!0,this.maxZoomScale=t,this.zoomDuration=0|e,e&&(this.zoomIncrement=1e3*(Math.abs(this.maxZoomScale-this.currentZoomScale)/e)),1>this.maxZoomScale?e?this.zoomIncrement=-1*this.zoomIncrement:(this.isZooming=!1,this.setCurrentZoomScale(this.maxZoomScale)):e||(this.isZooming=!1,this.setCurrentZoomScale(this.maxZoomScale))},e.prototype.getZoom=function(){return this.currentZoomScale},e.prototype.setCurrentZoomScale=function(t){this.currentZoomScale=t},e.prototype.update=function(t){var e=this.getFocus(),i=0,s=0,n=this.engine.ctx.canvas.width,o=this.engine.ctx.canvas.height;n*this.getZoom(),o*this.getZoom(),this.isDoneShaking()?(this.isShaking=!1,this.elapsedShakeTime=0,this.shakeMagnitudeX=0,this.shakeMagnitudeY=0,this.shakeDuration=0):(this.elapsedShakeTime+=t,i=(0|Math.random()*this.shakeMagnitudeX)+1,s=(0|Math.random()*this.shakeMagnitudeY)+1),this.engine.ctx.translate(e.x+i,e.y+s),this.isDoneZooming()?(this.isZooming=!1,this.elapsedZoomTime=0,this.zoomDuration=0,this.setCurrentZoomScale(this.maxZoomScale)):(this.elapsedZoomTime+=t,this.setCurrentZoomScale(this.getZoom()+this.zoomIncrement*t/1e3)),this.engine.ctx.scale(this.getZoom(),this.getZoom())},e.prototype.debugDraw=function(t){this.getFocus(),t.fillStyle="yellow",t.beginPath(),t.arc(this.follow.x+this.follow.getWidth()/2,0,15,0,2*Math.PI),t.closePath(),t.fill()},e.prototype.isDoneShaking=function(){return!this.isShaking||this.elapsedShakeTime>=this.shakeDuration},e.prototype.isDoneZooming=function(){return 0!=this.zoomDuration?this.elapsedZoomTime>=this.zoomDuration:1>this.maxZoomScale?this.currentZoomScale<=this.maxZoomScale:this.currentZoomScale>=this.maxZoomScale},e}();t.BaseCamera=e;var i=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype.getFocus=function(){return this.follow?new t.Point((-this.follow.x-this.follow.getWidth()/2)*this.getZoom()+this.engine.getWidth()*this.getZoom()/2,0):this.focus},i}(e);t.SideCamera=i;var s=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype.getFocus=function(){return this.follow?new t.Point((-this.follow.x-this.follow.getWidth()/2)*this.getZoom()+this.engine.getWidth()*this.getZoom()/2,(-this.follow.y-this.follow.getHeight()/2)*this.getZoom()+this.engine.getHeight()*this.getZoom()/2):this.focus},i}(e);t.TopCamera=s})(ex||(ex={}));var ex;(function(t){var e=function(){function e(e){this.path=e,this._isLoaded=!1,this.logger=t.Logger.getInstance(),this.onprogress=function(){},this.oncomplete=function(){},this.onerror=function(){},this._innerElement=document.createElement("div"),this._innerElement.className="excalibur-template"}return e.prototype.getTemplateString=function(){return this._isLoaded?this._htmlString:""},e.prototype._compile=function(){this._innerElement.innerHTML=this._htmlString,this._styleElements=this._innerElement.querySelectorAll("[data-style]"),this._textElements=this._innerElement.querySelectorAll("[data-text]")},e.prototype._evaluateExpresion=function(t,e){var i=Function("return "+t+";"),s=i.call(e);return s},e.prototype.apply=function(t){for(var e=this,i=0;this._styleElements.length>i;i++)(function(){var s={};e._styleElements[i].dataset.style.split(";").forEach(function(t){if(t){var e=t.split(":");s[e[0].trim()]=e[1].trim()}});for(var n in s)(function(){var o=s[n];e._styleElements[i].style[n]=e._evaluateExpresion(o,t)})()})();for(var s=0;this._textElements.length>s;s++)(function(){var i=e._textElements[s].dataset.text;e._textElements[s].innerText=e._evaluateExpresion(i,t)})();return 1===this._innerElement.children.length&&(this._innerElement=this._innerElement.firstChild),this._innerElement},e.prototype.load=function(){var e=this,i=new t.Promise,s=new XMLHttpRequest;return s.open("GET",this.path,!0),s.responseType="text",s.onprogress=this.onprogress,s.onerror=this.onerror,s.onload=function(){return 200!==s.status?(e.logger.error("Failed to load html template resource ",e.path," server responded with error code",s.status),e.onerror(s.response),e._isLoaded=!1,i.resolve("error"),void 0):(e._htmlString=s.response,e.oncomplete(),e.logger.debug("Completed loading template",e.path),e._compile(),e._isLoaded=!0,i.resolve(e._htmlString),void 0)},s.overrideMimeType&&s.overrideMimeType("text/plain; charset=x-user-defined"),s.send(),i},e.prototype.isLoaded=function(){return this._isLoaded},e}();t.Template=e;var i=function(){function t(t,e,i){this.parent=document.getElementById(t),this.template=e,this._ctx=i,this.update()}return t.prototype.listen=function(t,e,i){var s=this;i||(i=function(){s.update()}),t.addEventListener&&e.forEach(function(e){t.addEventListener(e,i)})},t.prototype.update=function(){var t=this._applyTemplate(this.template,this._ctx);t instanceof String&&(this.parent.innerHTML=t),t instanceof Node&&this.parent.lastChild!==t&&this.parent.appendChild(t)},t.prototype._applyTemplate=function(t,e){return t.isLoaded()?t.apply(e):void 0},t}();t.Binding=i})(ex||(ex={}));var ex;(function(t){var e=function(){function t(t,e,i,s){this.r=t,this.g=e,this.b=i,this.a=s,this.a=null!=s?s:1}return t.fromRGB=function(e,i,s,n){return new t(e,i,s,n)},t.fromHex=function(e){var i=/^#?([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i,s=null;if(s=e.match(i)){var n=parseInt(s[1],16),o=parseInt(s[2],16),r=parseInt(s[3],16),h=1;return s[4]&&(h=parseInt(s[4],16)/255),new t(n,o,r,h)}throw Error("Invalid hex string: "+e)},t.prototype.toString=function(){var t=this.r.toFixed(0)+""+", "+(this.g.toFixed(0)+"")+", "+(this.b.toFixed(0)+"");return this.a?"rgba("+t+", "+(this.a+"")+")":"rgb("+t+")"},t.prototype.clone=function(){return new t(this.r,this.g,this.b,this.a)},t.Black=t.fromHex("#000000"),t.White=t.fromHex("#FFFFFF"),t.Yellow=t.fromHex("#FFFF00"),t.Orange=t.fromHex("#FFA500"),t.Red=t.fromHex("#FF0000"),t.Vermillion=t.fromHex("#FF5B31"),t.Rose=t.fromHex("#FF007F"),t.Magenta=t.fromHex("#FF00FF"),t.Violet=t.fromHex("#7F00FF"),t.Blue=t.fromHex("#0000FF"),t.Azure=t.fromHex("#007FFF"),t.Cyan=t.fromHex("#00FFFF"),t.Viridian=t.fromHex("#59978F"),t.Green=t.fromHex("#00FF00"),t.Chartreuse=t.fromHex("#7FFF00"),t.Transparent=t.fromHex("#FFFFFF00"),t}();t.Color=e,function(t){t[t.Num1=97]="Num1",t[t.Num2=98]="Num2",t[t.Num3=99]="Num3",t[t.Num4=100]="Num4",t[t.Num5=101]="Num5",t[t.Num6=102]="Num6",t[t.Num7=103]="Num7",t[t.Num8=104]="Num8",t[t.Num9=105]="Num9",t[t.Num0=96]="Num0",t[t.Numlock=144]="Numlock",t[t.Semicolon=186]="Semicolon",t[t.A=65]="A",t[t.B=66]="B",t[t.C=67]="C",t[t.D=68]="D",t[t.E=69]="E",t[t.F=70]="F",t[t.G=71]="G",t[t.H=72]="H",t[t.I=73]="I",t[t.J=74]="J",t[t.K=75]="K",t[t.L=76]="L",t[t.M=77]="M",t[t.N=78]="N",t[t.O=79]="O",t[t.P=80]="P",t[t.Q=81]="Q",t[t.R=82]="R",t[t.S=83]="S",t[t.T=84]="T",t[t.U=85]="U",t[t.V=86]="V",t[t.W=87]="W",t[t.X=88]="X",t[t.Y=89]="Y",t[t.Z=90]="Z",t[t.Shift=16]="Shift",t[t.Alt=18]="Alt",t[t.Up=38]="Up",t[t.Down=40]="Down",t[t.Left=37]="Left",t[t.Right=39]="Right",t[t.Space=32]="Space",t[t.Esc=27]="Esc"}(t.InputKey||(t.InputKey={}));var i=t.InputKey;(function(t){t[t.FullScreen=0]="FullScreen",t[t.Container=1]="Container",t[t.Fixed=2]="Fixed"})(t.DisplayMode||(t.DisplayMode={})),t.DisplayMode;var s=function(){function t(t,e,i){this.animation=t,this.x=e,this.y=i}return t}(),n=function(){function t(e,i,s){this.id=0,this.interval=10,this.fcn=function(){},this.repeats=!1,this.elapsedTime=0,this.complete=!1,this.scene=null,this.id=t.id++,this.interval=i||this.interval,this.fcn=e||this.fcn,this.repeats=s||this.repeats}return t.prototype.update=function(t){this.elapsedTime+=t,this.elapsedTime>this.interval&&(this.fcn.call(this),this.repeats?this.elapsedTime=0:this.complete=!0)},t.prototype.cancel=function(){this.scene&&this.scene.cancelTimer(this)},t.id=0,t}();t.Timer=n;var o=function(n){function o(i,s,o,r){n.call(this),this.hasStarted=!1,this.keys=[],this.keysDown=[],this.keysUp=[],this.clicks=[],this.mouseDown=[],this.mouseMove=[],this.mouseUp=[],this.touchStart=[],this.touchMove=[],this.touchEnd=[],this.touchCancel=[],this.sceneHash={},this.animations=[],this.isFullscreen=!1,this.displayMode=0,this.isDebug=!1,this.debugColor=new e(255,255,255),this.backgroundColor=new e(0,0,100),this.isSmoothingEnabled=!0,this.isLoading=!1,this.progress=0,this.total=1,console.log("Powered by Excalibur.js visit","http://excaliburjs.com","for more information."),this.logger=t.Logger.getInstance(),this.logger.debug("Building engine..."),this.canvasElementId=o,this.rootScene=this.currentScene=new t.Scene,this.addScene("root",this.rootScene),o?(this.logger.debug("Using Canvas element specified: "+o),this.canvas=document.getElementById(o)):(this.logger.debug("Using generated canvas element"),this.canvas=document.createElement("canvas")),i&&s?(void 0==r&&(this.displayMode=2),this.logger.debug("Engine viewport is size "+i+" x "+s),this.width=i,this.canvas.width=i,this.height=s,this.canvas.height=s):r||(this.logger.debug("Engine viewport is fullscreen"),this.displayMode=0),this.loader=new t.Loader,this.initialize()}return __extends(o,n),o.prototype.playAnimation=function(t,e,i){this.animations.push(new s(t,e,i))},o.prototype.addChild=function(t){this.currentScene.addChild(t)},o.prototype.removeChild=function(t){this.currentScene.removeChild(t)},o.prototype.addCollisionMap=function(t){this.currentScene.addCollisionMap(t)},o.prototype.removeCollisionMap=function(t){this.currentScene.removeCollisionMap(t)},o.prototype.addTimer=function(t){return this.currentScene.addTimer(t)},o.prototype.removeTimer=function(t){return this.currentScene.removeTimer(t)},o.prototype.addScene=function(t,e){this.sceneHash[t]&&this.logger.warn("Scene",t,"already exists overwriting"),this.sceneHash[t]=e,e.engine=this},o.prototype.goToScene=function(e){if(this.sceneHash[e]){this.currentScene.onDeactivate.call(this.currentScene);var i=this.currentScene;this.currentScene=this.sceneHash[e],i.eventDispatcher.publish("deactivate",new t.DeactivateEvent(this.currentScene)),i.eventDispatcher.update(),this.currentScene.onActivate.call(this.currentScene),this.currentScene.eventDispatcher.publish("activate",new t.ActivateEvent(i)),this.currentScene.eventDispatcher.update()}else this.logger.error("Scene",e,"does not exist!")},o.prototype.getWidth=function(){return this.camera?this.width/this.camera.getZoom():this.width},o.prototype.getHeight=function(){return this.camera?this.height/this.camera.getZoom():this.height},o.prototype.screenToWorldCoordinates=function(e){var i=e.x,s=e.y;if(this.camera){var n=this.camera.getFocus();i-=n.x,s-=n.y}return i=Math.floor(i/this.canvas.clientWidth*this.getWidth()),s=Math.floor(s/this.canvas.clientHeight*this.getHeight()),new t.Point(i,s)},o.prototype.worldToScreenCoordinates=function(e){var i=e.x,s=e.y;if(this.camera){var n=this.camera.getFocus();i+=n.x*(this.getWidth()/this.canvas.clientWidth),s+=n.y*(this.getHeight()/this.canvas.clientHeight)}return i=Math.floor(i/this.getWidth()*this.canvas.clientWidth),s=Math.floor(s/this.getHeight()*this.canvas.clientHeight),new t.Point(i,s)},o.prototype.setHeightByDisplayMode=function(t){1===this.displayMode&&(this.width=this.canvas.width=t.clientWidth,this.height=this.canvas.height=t.clientHeight),0===this.displayMode&&(document.body.style.margin="0px",document.body.style.overflow="hidden",this.width=this.canvas.width=t.innerWidth,this.height=this.canvas.height=t.innerHeight)},o.prototype.initialize=function(){var e=this;if(0===this.displayMode||1===this.displayMode){var i=1===this.displayMode?this.canvas.parentElement||document.body:window;this.setHeightByDisplayMode(i),window.addEventListener("resize",function(){e.logger.debug("View port resized"),e.setHeightByDisplayMode(i),e.logger.info("parent.clientHeight "+i.clientHeight),e.setAntialiasing(e.isSmoothingEnabled)})}window.addEventListener("blur",function(){e.keys.length=0}),window.addEventListener("keyup",function(i){var s=e.keys.indexOf(i.keyCode);e.keys.splice(s,1),e.keysUp.push(i.keyCode);var n=new t.KeyUp(i.keyCode);e.eventDispatcher.publish(t.EventType[1],n),e.currentScene.publish(t.EventType[1],n)}),window.addEventListener("keydown",function(i){if(-1===e.keys.indexOf(i.keyCode)){e.keys.push(i.keyCode),e.keysDown.push(i.keyCode);var s=new t.KeyDown(i.keyCode);e.eventDispatcher.publish(t.EventType[0],s),e.currentScene.publish(t.EventType[0],s)}}),window.addEventListener("blur",function(){e.eventDispatcher.publish(t.EventType[14],new t.BlurEvent),e.eventDispatcher.update()}),window.addEventListener("focus",function(){e.eventDispatcher.publish(t.EventType[15],new t.FocusEvent),e.eventDispatcher.update()}),this.canvas.addEventListener("mousedown",function(i){var s=i.pageX-t.Util.getPosition(e.canvas).x,n=i.pageY-t.Util.getPosition(e.canvas).y,o=e.screenToWorldCoordinates(new t.Point(s,n)),r=new t.MouseDown(o.x,o.y,i);e.mouseDown.push(r),e.clicks.push(r),e.eventDispatcher.publish(t.EventType[3],r)}),this.canvas.addEventListener("mousemove",function(i){var s=i.pageX-t.Util.getPosition(e.canvas).x,n=i.pageY-t.Util.getPosition(e.canvas).y,o=e.screenToWorldCoordinates(new t.Point(s,n)),r=new t.MouseMove(o.x,o.y,i);e.mouseMove.push(r),e.eventDispatcher.publish(t.EventType[4],r)}),this.canvas.addEventListener("mouseup",function(i){var s=i.pageX-t.Util.getPosition(e.canvas).x,n=i.pageY-t.Util.getPosition(e.canvas).y,o=e.screenToWorldCoordinates(new t.Point(s,n)),r=new t.MouseUp(o.x,o.y,i);e.mouseUp.push(r),e.eventDispatcher.publish(t.EventType[5],r)}),this.canvas.addEventListener("touchstart",function(i){var s=i;s.preventDefault();var n=s.changedTouches[0].pageX-t.Util.getPosition(e.canvas).x,o=s.changedTouches[0].pageY-t.Util.getPosition(e.canvas).y,r=e.screenToWorldCoordinates(new t.Point(n,o)),h=new t.TouchStart(r.x,r.y);e.touchStart.push(h),e.eventDispatcher.publish(t.EventType[6],h)}),this.canvas.addEventListener("touchmove",function(i){var s=i;s.preventDefault();var n=s.changedTouches[0].pageX-t.Util.getPosition(e.canvas).x,o=s.changedTouches[0].pageY-t.Util.getPosition(e.canvas).y,r=e.screenToWorldCoordinates(new t.Point(n,o)),h=new t.TouchMove(r.x,r.y);e.touchMove.push(h),e.eventDispatcher.publish(t.EventType[7],h)}),this.canvas.addEventListener("touchend",function(i){var s=i;s.preventDefault();var n=s.changedTouches[0].pageX-t.Util.getPosition(e.canvas).x,o=s.changedTouches[0].pageY-t.Util.getPosition(e.canvas).y,r=e.screenToWorldCoordinates(new t.Point(n,o)),h=new t.TouchEnd(r.x,r.y);e.touchEnd.push(h),e.eventDispatcher.publish(t.EventType[8],h)}),this.canvas.addEventListener("touchcancel",function(i){var s=i;s.preventDefault();var n=s.changedTouches[0].pageX-t.Util.getPosition(e.canvas).x,o=s.changedTouches[0].pageY-t.Util.getPosition(e.canvas).y,r=e.screenToWorldCoordinates(new t.Point(n,o)),h=new t.TouchCancel(r.x,r.y);e.touchCancel.push(h),e.eventDispatcher.publish(t.EventType[9],h)}),navigator.maxTouchPoints&&(this.canvas.addEventListener("pointerdown",function(i){if("touch"===i.pointerType){i.preventDefault();var s=i.pageX-t.Util.getPosition(e.canvas).x,n=i.pageY-t.Util.getPosition(e.canvas).y,o=e.screenToWorldCoordinates(new t.Point(s,n)),r=new t.TouchStart(o.x,o.y);e.touchStart.push(r),e.eventDispatcher.publish(t.EventType[6],r)}}),this.canvas.addEventListener("pointermove",function(i){if("touch"===i.pointerType){i.preventDefault();var s=i.pageX-t.Util.getPosition(e.canvas).x,n=i.pageY-t.Util.getPosition(e.canvas).y,o=e.screenToWorldCoordinates(new t.Point(s,n)),r=new t.TouchMove(o.x,o.y);e.touchMove.push(r),e.eventDispatcher.publish(t.EventType[7],r)}}),this.canvas.addEventListener("pointerup",function(i){if("touch"===i.pointerType){i.preventDefault();var s=i.pageX-t.Util.getPosition(e.canvas).x,n=i.pageY-t.Util.getPosition(e.canvas).y,o=e.screenToWorldCoordinates(new t.Point(s,n)),r=new t.TouchEnd(o.x,o.y);e.touchEnd.push(r),e.eventDispatcher.publish(t.EventType[8],r)}})),this.ctx=this.canvas.getContext("2d"),this.canvasElementId||document.body.appendChild(this.canvas)},o.prototype.setAntialiasing=function(t){this.isSmoothingEnabled=t,this.ctx.imageSmoothingEnabled=t,this.ctx.webkitImageSmoothingEnabled=t,this.ctx.mozImageSmoothingEnabled=t,this.ctx.msImageSmoothingEnabled=t},o.prototype.getAntialiasing=function(){return this.ctx.imageSmoothingEnabled||this.ctx.webkitImageSmoothingEnabled||this.ctx.mozImageSmoothingEnabled||this.ctx.msImageSmoothingEnabled},o.prototype.isKeyDown=function(t){return this.keysDown.indexOf(t)>-1},o.prototype.isKeyPressed=function(t){return this.keys.indexOf(t)>-1},o.prototype.isKeyUp=function(t){return this.keysUp.indexOf(t)>-1},o.prototype.update=function(e){if(!this.isLoading){this.eventDispatcher.update(),this.currentScene.update(this,e);var s=this.eventDispatcher;this.keys.forEach(function(e){s.publish(i[e],new t.KeyEvent(e))}),this.animations=this.animations.filter(function(t){return!t.animation.isDone()}),this.keysDown.length=0,this.keysUp.length=0,this.clicks.length=0,this.mouseDown.length=0,this.mouseMove.length=0,this.mouseUp.length=0,this.touchStart.length=0,this.touchMove.length=0,this.touchEnd.length=0,this.touchCancel.length=0,this.eventDispatcher.publish(t.EventType[16],new t.UpdateEvent(e))}},o.prototype.draw=function(t){var e=this.ctx;if(this.isLoading)return e.fillStyle="black",e.fillRect(0,0,this.width,this.height),this.drawLoadingBar(e,this.progress,this.total),void 0;if(e.clearRect(0,0,this.width,this.height),e.fillStyle=""+this.backgroundColor,e.fillRect(0,0,this.width,this.height),this.isDebug){this.ctx.font="Consolas",this.ctx.fillStyle=""+this.debugColor;for(var s=0;this.keys.length>s;s++)this.ctx.fillText(""+this.keys[s]+" : "+(i[this.keys[s]]?i[this.keys[s]]:"Not Mapped"),100,10*s+10);var n=1/(t/1e3);this.ctx.fillText("FPS:"+(""+n.toFixed(2)),10,10)}this.ctx.save(),this.camera&&this.camera.update(t),this.currentScene.draw(this.ctx,t),this.animations.forEach(function(t){t.animation.draw(e,t.x,t.y)}),this.isDebug&&(this.ctx.strokeStyle="yellow",this.currentScene.debugDraw(this.ctx),this.camera.debugDraw(this.ctx)),this.ctx.restore()},o.prototype.start=function(t){var e;if(t&&(e=this.load(t)),!this.hasStarted){this.hasStarted=!0,this.logger.debug("Starting game...");var i=Date.now(),s=this;(function n(){if(s.hasStarted){window.requestAnimationFrame(n);var t=Date.now(),e=Math.floor(t-i)||1;e>200&&(e=1),s.update(e),s.draw(e),i=t}})(),this.logger.debug("Game started")}return e},o.prototype.stop=function(){this.hasStarted&&(this.hasStarted=!1,this.logger.debug("Game stopped"))},o.prototype.drawLoadingBar=function(t,e,i){if(this.loadingDraw)return this.loadingDraw(t,e,i),void 0;var s=this.canvas.height/2,n=this.canvas.width/3,o=n,r=new Image;r.src="data:image/png;base64,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";
var h=3*n/8,a=this.getAntialiasing();this.setAntialiasing(!0),t.drawImage(r,0,0,800,300,o,s-h-20,n,h),t.strokeStyle="white",t.lineWidth=2,t.strokeRect(o,s,n,20);var c=n*(e/i);t.fillStyle="white";var l=5,n=c-2*l,u=20-2*l;t.fillRect(o+l,s+l,n>0?n:0,u),this.setAntialiasing(a)},o.prototype.setLoadingDrawFunction=function(t){this.loadingDraw=t},o.prototype.load=function(e){var i=this,s=new t.Promise;return this.isLoading=!0,e.load(),e.onprogress=function(t){i.progress=t.loaded,i.total=t.total,i.logger.debug("Loading "+(100*i.progress/i.total).toFixed(0))},e.oncomplete=function(){setTimeout(function(){i.isLoading=!1,s.resolve()},500)},s},o}(t.Util.Class);t.Engine=o})(ex||(ex={}));